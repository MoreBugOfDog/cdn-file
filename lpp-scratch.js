/// Copyright (c) FurryR 2023. This project is licensed under the MIT license.
/// Original repository: https://github.com/FurryR/lpp-scratch

"use strict";(()=>{var Mt=Object.defineProperty;var me=(r,t)=>{for(var e in t)Mt(r,e,{get:t[e],enumerable:!0})};var Ue="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSJub25lIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2MDAiIGhlaWdodD0iMzcyIiB2aWV3Qm94PSIwIDAgNjAwIDM3MiI+PGc+PGc+PHBhdGggZD0iTTI3Ni40NTMxNDgzMzk4NDM4LDExMC45MjQ4MDQ2ODc1TDIxMC45NzQ1NDgzMzk4NDM3NSwxMTAuOTI0ODA0Njg3NUwyMTAuOTc0NTQ4MzM5ODQzNzUsMzUyLjUxMDgwNDY4NzVMMjExLjAwMDAwMDAzOTg0Mzc0LDM1Mi41MTA4MDQ2ODc1TDIxMS4wMDAwMDAwMzk4NDM3NCwzNzEuOTk5ODA0Njg3NUwyMzIuMDAwMDQ4MzM5ODQzNzQsMzcxLjk5OTgwNDY4NzVMMjMyLjAwMDA0ODMzOTg0Mzc0LDI0MS45NTQ4MDQ2ODc1TDI3Ni40NTMxNDgzMzk4NDM4LDI0MS45NTQ4MDQ2ODc1QzMxMi42MTU1NDgzMzk4NDM3NywyNDEuOTU0ODA0Njg3NSwzNDEuOTMxNTQ4MzM5ODQzNzQsMjEyLjYyMjgwNDY4NzQ5OTk4LDM0MS45MzE1NDgzMzk4NDM3NCwxNzYuNDM5NjA0Njg3NDk5OThDMzQxLjkzMTU0ODMzOTg0Mzc0LDE0MC4yNTY4MDQ2ODc1LDMxMi42MTU1NDgzMzk4NDM3NywxMTAuOTI0ODA0Njg3NSwyNzYuNDUzMTQ4MzM5ODQzOCwxMTAuOTI0ODA0Njg3NVpNMjMyLjAwMDA0ODMzOTg0Mzc0LDEzMS4zOTgyMDQ2ODc1TDIzMi4wMDAwNDgzMzk4NDM3NCwyMjEuNDgwODA0Njg3NDk5OThMMjc2LjQ1MzE0ODMzOTg0MzgsMjIxLjQ4MDgwNDY4NzQ5OTk4UTI4NS4wMzk3NDgzMzk4NDM3NSwyMjEuNDgwODA0Njg3NDk5OTgsMjkzLjAyMzQ0ODMzOTg0Mzc1LDIxOC4zMTg4MDQ2ODc1UTMwMS42OTIwNDgzMzk4NDM3LDIxNC44ODQ4MDQ2ODc0OTk5OCwzMDguMjg0NjQ4MzM5ODQzOCwyMDguMjg4NzA0Njg3NVEzMTQuODc3NTQ4MzM5ODQzNzcsMjAxLjY5MjUwNDY4NzUsMzE4LjMwODU0ODMzOTg0Mzc1LDE5My4wMTkxMDQ2ODc1UTMyMS40Njk1NDgzMzk4NDM3NSwxODUuMDMxMDA0Njg3NSwzMjEuNDY5NTQ4MzM5ODQzNzUsMTc2LjQzOTYwNDY4NzQ5OTk4UTMyMS40Njk1NDgzMzk4NDM3NSwxNjcuODQ4MjA0Njg3NTAwMDIsMzE4LjMwODU0ODMzOTg0Mzc1LDE1OS44NjAxMDQ2ODc0OTk5OFEzMTQuODc3NTQ4MzM5ODQzNzcsMTUxLjE4NjcwNDY4NzUsMzA4LjI4NDY0ODMzOTg0MzgsMTQ0LjU5MDUwNDY4NzUwMDAyUTMwMS42OTIxNDgzMzk4NDM3NSwxMzcuOTk0MzA0Njg3NSwyOTMuMDIzNDQ4MzM5ODQzNzUsMTM0LjU2MDYwNDY4NzVRMjg1LjAzOTc0ODMzOTg0Mzc1LDEzMS4zOTgyMDQ2ODc1LDI3Ni40NTMxNDgzMzk4NDM4LDEzMS4zOTgyMDQ2ODc1TDIzMi4wMDAwNDgzMzk4NDM3NCwxMzEuMzk4MjA0Njg3NVoiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZmlsbC1vcGFjaXR5PSIxIi8+PC9nPjxnPjxwYXRoIGQ9Ik0xMzYuMTA4NzE2ODk0NTMxMjYsMEw4Ni45OTk4MTY4OTQ1MzEyNSwwTDg2Ljk5OTgxNjg5NDUzMTI1LDIwLjQ3MzRMMTE1LjY0NjcxNjg5NDUzMTI1LDIwLjQ3MzRMMTE1LjY0NjcxNjg5NDUzMTI1LDE3Ni4wNzFDMTE1LjY0NjcxNjg5NDUzMTI1LDIxMi4yNTQsMTQ0Ljk2MjQxNjg5NDUzMTI2LDI0MS41ODYsMTgxLjEyNTMxNjg5NDUzMTI0LDI0MS41ODZMMTkxLjM1NTgxNjg5NDUzMTI0LDI0MS41ODZMMTkxLjM1NTgxNjg5NDUzMTI0LDIyMS4xMTJMMTgxLjEyNTMxNjg5NDUzMTI0LDIyMS4xMTJRMTcyLjUzODYxNjg5NDUzMTIzLDIyMS4xMTIsMTY0LjU1NDkxNjg5NDUzMTIzLDIxNy45NVExNTUuODg2MzE2ODk0NTMxMjYsMjE0LjUxNiwxNDkuMjkzODE2ODk0NTMxMjMsMjA3LjkyUTE0Mi43MDEzMTY4OTQ1MzEyNiwyMDEuMzI0LDEzOS4yNjk0MTY4OTQ1MzEyNSwxOTIuNjUxUTEzNi4xMDg3MTY4OTQ1MzEyNiwxODQuNjYyLDEzNi4xMDg3MTY4OTQ1MzEyNiwxNzYuMDcxTDEzNi4xMDg3MTY4OTQ1MzEyNiwwWiIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjODY4Njg2IiBmaWxsLW9wYWNpdHk9IjEiLz48L2c+PGc+PHBhdGggZD0iTTQyNy40Nzg2MDAwMDAwMDAwMywxMTFMMzYyLDExMUwzNjIsMzUyLjU4NkwzNjIuMDI1NDUxNywzNTIuNTg2TDM2Mi4wMjU0NTE3LDM3MkwzODMuMDI1NSwzNzJMMzgzLjAyNTUsMjQyLjAzTDQyNy40Nzg2MDAwMDAwMDAwMywyNDIuMDNDNDYzLjY0MSwyNDIuMDMsNDkyLjk1NywyMTIuNjk3OTk5OTk5OTk5OTgsNDkyLjk1NywxNzYuNTE0Nzk5OTk5OTk5OThDNDkyLjk1NywxNDAuMzMyLDQ2My42NDEsMTExLDQyNy40Nzg2MDAwMDAwMDAwMywxMTFaTTM4My4wMjU1LDEzMS40NzM0TDM4My4wMjU1LDIyMS41NTU5OTk5OTk5OTk5OEw0MjcuNDc4NjAwMDAwMDAwMDMsMjIxLjU1NTk5OTk5OTk5OTk4UTQzNi4wNjUyLDIyMS41NTU5OTk5OTk5OTk5OCw0NDQuMDQ4OSwyMTguMzk0UTQ1Mi43MTc1LDIxNC45NTk5OTk5OTk5OTk5OCw0NTkuMzEwMTAwMDAwMDAwMDMsMjA4LjM2MzlRNDY1LjkwMywyMDEuNzY3Nyw0NjkuMzM0LDE5My4wOTQzUTQ3Mi40OTUsMTg1LjEwNjIsNDcyLjQ5NSwxNzYuNTE0Nzk5OTk5OTk5OThRNDcyLjQ5NSwxNjcuOTIzNDAwMDAwMDAwMDIsNDY5LjMzNCwxNTkuOTM1Mjk5OTk5OTk5OThRNDY1LjkwMywxNTEuMjYxOSw0NTkuMzEwMTAwMDAwMDAwMDMsMTQ0LjY2NTcwMDAwMDAwMDAyUTQ1Mi43MTc2LDEzOC4wNjk1LDQ0NC4wNDg5LDEzNC42MzU4UTQzNi4wNjUyLDEzMS40NzM0LDQyNy40Nzg2MDAwMDAwMDAwMywxMzEuNDczNEwzODMuMDI1NSwxMzEuNDczNFoiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzg2ODY4NiIgZmlsbC1vcGFjaXR5PSIxIi8+PC9nPjxnIHRyYW5zZm9ybT0ibWF0cml4KDAuNzA2OTExMjA2MjQ1NDIyNCwwLjcwNzMwMjMzMTkyNDQzODUsLTAuNzA2OTExMjA2MjQ1NDIyNCwwLjcwNzMwMjMzMTkyNDQzODUsOTIuODA5NzA0OTIwMDgyMzcsLTE5LjEyMjU5OTY2NzQwMDIxKSI+PHBhdGggZD0iTTg5LjkxODIxNTc0NzA3MDMyLDEwMi40OTQ1MzczNTM1MTU2Mkw2OS40NTA1MTU3NDcwNzAzMSwxMDIuNDk0NTM3MzUzNTE1NjJMNjkuNDUwNTE1NzQ3MDcwMzEsMjAwLjczOTUzNzM1MzUxNTYzTDE2Ny42OTU1MTU3NDcwNzAzMiwyMDAuNzM5NTM3MzUzNTE1NjNMMTY3LjY5NTUxNTc0NzA3MDMyLDE4MC4yNzE4MzczNTM1MTU2Mkw4OS45MTgyMTU3NDcwNzAzMiwxODAuMjcxODM3MzUzNTE1NjJMODkuOTE4MjE1NzQ3MDcwMzIsMTAyLjQ5NDUzNzM1MzUxNTYyWiIgZmlsbC1ydWxlPSJldmVub2RkIiBmaWxsPSIjNDY0NjQ2IiBmaWxsLW9wYWNpdHk9IjEiLz48L2c+PGcgdHJhbnNmb3JtPSJtYXRyaXgoLTAuNzA2OTExMDg3MDM2MTMyOCwtMC43MDczMDIzMzE5MjQ0Mzg1LDAuNzA2OTExMjA2MjQ1NDIyNCwtMC43MDczMDIyNzIzMTk3OTM3LDczNS4wOTE5NzYwNjU1OTYxLDc4Ny4wNjQ3MDc5NjU0MykiPjxwYXRoIGQ9Ik01NTEuMDE3MTk5NTExNzE4OCwyNDEuMjAyNjM2NzE4NzVMNTMwLjU0OTQ5OTUxMTcxODgsMjQxLjIwMjYzNjcxODc1TDUzMC41NDk0OTk1MTE3MTg4LDMzOS40NDc2MzY3MTg3NUw2MjguNzk0NDk5NTExNzE4OCwzMzkuNDQ3NjM2NzE4NzVMNjI4Ljc5NDQ5OTUxMTcxODgsMzE4Ljk3OTkzNjcxODc0OTk3TDU1MS4wMTcxOTk1MTE3MTg4LDMxOC45Nzk5MzY3MTg3NDk5N0w1NTEuMDE3MTk5NTExNzE4OCwyNDEuMjAyNjM2NzE4NzVaIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiM0NjQ2NDYiIGZpbGwtb3BhY2l0eT0iMSIvPjwvZz48L2c+PC9zdmc+";var ze={};me(ze,{Global:()=>D,LppArray:()=>E,LppClosure:()=>he,LppConstant:()=>l,LppContext:()=>te,LppError:()=>L,LppException:()=>R,LppFunction:()=>w,LppFunctionContext:()=>ce,LppHandle:()=>Te,LppObject:()=>M,LppPromise:()=>Y,LppReference:()=>x,LppReturn:()=>m,LppTraceback:()=>ee,LppValue:()=>I,asBoolean:()=>z,asValue:()=>y,async:()=>g,ffi:()=>ie,isPromise:()=>J,raise:()=>j});var L=class extends Error{constructor(e){super(`lpp: Error ${e}`);this.id=e}},I=class{};function y(r){return r instanceof x?r.value:r}function z(r){if(r instanceof l){if(r.value===null)return!1;switch(typeof r.value){case"number":return r.value!==0;case"boolean":return r.value;case"string":return r.value.length!==0}return!1}else{if(r instanceof E)return r.value.length!==0;if(r instanceof M)return r.value.size!==0;if(r instanceof w)return!0}return!1}function J(r){return typeof r=="object"&&r!==null&&typeof r.then=="function"}function g(r,...t){let e=r(...t);function o(p){let s=e.next(p);return J(s.value)?s.done?s.value:s.value.then(a=>o(a)):s.done?s.value:o(s.value)}return o()}function ye(r,t,e){if(!(r instanceof l&&e instanceof l))return NaN;let o=typeof r.value=="boolean"?+r.value:r.value,p=typeof e.value=="boolean"?+e.value:e.value,a=new Map([["+",(i,n)=>i+n],["-",(i,n)=>i-n],["*",(i,n)=>i*n],["/",(i,n)=>i/n],["<<",(i,n)=>i<<n],[">>",(i,n)=>i>>n],[">>>",(i,n)=>i>>>n],["&",(i,n)=>i&n],["|",(i,n)=>i|n],["^",(i,n)=>i^n]]).get(t);if(!a)throw new Error("lpp: not implemented");return a(o,p)}function X(r,t){return r=r instanceof l&&typeof r.value=="boolean"?new l(+r.value):r,t=t instanceof l&&typeof t.value=="boolean"?new l(+t.value):t,r instanceof l&&t instanceof l?r.value===t.value:r===t}function le(r,t,e){function o(a,i,n){if(i instanceof l){if(n instanceof l){if(i.value===null||n.value===null)return!1;switch(typeof i.value){case"boolean":switch(typeof n.value){case"boolean":return a(+i.value,+n.value);case"number":return a(+i.value,n.value);case"string":return a(+i.value,n.value.length?1:0);default:throw new Error("lpp: unknown rhs")}case"number":switch(typeof n.value){case"boolean":return a(i.value,+n.value);case"number":return a(i.value,n.value);case"string":return a(i.value?1:0,n.value.length?1:0);default:throw new Error("lpp: unknown rhs")}case"string":switch(typeof n.value){case"boolean":return a(i.value.length?1:0,+n.value);case"number":return a(i.value.length?1:0,n.value?1:0);case"string":return a(i.value,n.value);default:throw new Error("lpp: unknown rhs")}default:throw new Error("lpp: unknown lhs")}}return o(a,i,new l(z(n)))}return o(a,new l(z(i)),n)}let s=new Map([[">",(a,i)=>a>i],["<",(a,i)=>a<i],[">=",(a,i)=>a>=i],["<=",(a,i)=>a<=i]]).get(t);if(!s)throw new Error("lpp: not implemented");return o(s,r,e)}function K(r,t,e){if(r instanceof m){let o=r.value;if(!(o instanceof l)||o.value!==null){let p=y(o.get("then"));if(p instanceof w)return g(function*(){let s=yield p.apply(o,[new w(({args:a})=>g(function*(){return yield K(new m(a[0]??new l(null)),t,e),new m(new l(null))})),new w(({args:a})=>(e(a[0]??new l(null)),new m(new l(null))))]);return s instanceof R?void e(s.value):void 0})}return void t(r.value)}return void e(r.value)}function j(r){return r instanceof R?r:new R(r.value)}function Q(r,t){let e=new WeakSet;function o(p,s){if(p instanceof M){let a=p.value.get(s);if(a)return a;{let i=p.value.get("prototype");if(i instanceof M){if(e.has(i))throw new L("recursivePrototype");return e.add(i),Q(i,s)}}}return null}return o(r,t)}function Se(r,t){if(r===t)return!0;if(r.value.has("prototype")){let e=r.value.get("prototype");if(e instanceof M)return Se(e,t)}return!1}var M=class r extends I{constructor(e=new Map,o){super();this.value=e;this.value=e??new Map,o&&this.value.set("constructor",o)}get(e){if(e==="constructor")return this.value.get(e)??A.Object;{let o=this.value.get(e);if(o||e=="prototype")return new x(this,e,o??new l(null));let p=y(this.get("constructor"));if(!(p instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let s=y(p.get("prototype"));if(!(s instanceof r))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");let a=Q(s,e);return a===null?new x(this,e,new l(null)):new x(this,e,a)}}set(e,o){return this.value.set(e,o),new x(this,e,o)}has(e){if(e==="constructor"||this.value.has(e))return!0;let o=y(this.get("constructor"));if(!(o instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let p=y(o.get("prototype"));if(!(p instanceof r))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");return Q(p,e)!==null}delete(e){return this.value.delete(e)}instanceof(e){let o=this.get("constructor"),p=y(o.get("prototype")),s=y(e.get("prototype"));return p instanceof r&&s instanceof r?Se(p,s):!1}toString(){return"<Lpp Object>"}calc(e,o){if(o)switch(e){case"=":throw new L("assignOfConstant");case"+":{if(!(this instanceof w)&&o instanceof r&&!(o instanceof w)){if(this.value.has("constructor")||o.value.has("constructor"))return new l(NaN);let p=new r;for(let[s,a]of this.value.entries())p.set(s,a);for(let[s,a]of o.value.entries())p.set(s,a);return p}return new l(NaN)}case"==":return new l(X(this,o));case"!=":return new l(!X(this,o));case">":case"<":case">=":case"<=":return new l(le(this,e,o));case"&&":case"||":{let p=z(this),s=z(o);return new l(e==="&&"?p&&s:p||s)}case"instanceof":{if(o instanceof w)return new l(this.instanceof(o));throw new L("notCallable")}case"*":case"-":case"/":case"%":case"<<":case">>":case">>>":case"&":case"|":case"^":return new l(NaN)}else switch(e){case"delete":throw new L("assignOfConstant");case"!":return new l(!z(this));case"+":case"-":case"~":return new l(NaN)}throw new Error("lpp: unknown operand")}};var Y=class r extends M{constructor(e){super(new Map,A.Promise);this.pm=e}done(e,o){return r.generate((p,s)=>{this.pm.then(a=>{if(a instanceof I)return e?g(function*(){return K(yield e.apply(this,[a]),p,s)}.bind(this)):K(new m(a),p,s);throw new Error("lpp: unknown result")},a=>{if(a instanceof I)return o?g(function*(){return K(yield o.apply(this,[a]),p,s)}.bind(this)):s(a);throw a})})}error(e){return r.generate((o,p)=>{this.pm.catch(s=>{if(s instanceof I)return g(function*(){return K(yield e.apply(this,[s]),o,p)}.bind(this));throw s})})}static generate(e){let o,p;o=p=()=>{throw new Error("not initialized")};let s=new Promise((a,i)=>{o=a,p=i});return g(function*(){return yield e(o,p),new r(s)})}};var Te=class{constructor(t,e,o){this.fn=t;this.self=e;this.args=o}},w=class r extends M{constructor(e,o=new M){super(new Map,void 0);this.caller=e;this.value.set("prototype",o)}static native(e,o){function p(s,a){return s instanceof R&&s.pushStack(new ee.NativeFn(a.fn,a.self,a.args)),s}return new r(s=>g(function*(){return p(yield e(s),s)}),o)}get(e){if(e==="constructor")return A.Function;if(e==="prototype"){let o=this.value.get(e);if(o)return o;throw new Error("lpp: unexpected get -- prototype is null")}else{let o=this.value.get(e);if(o)return new x(this,e,o);let p=y(this.get("constructor"));if(!(p instanceof r))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let s=y(p.get("prototype"));if(!(s instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");let a=Q(s,e);return a===null?new x(this,e,new l(null)):new x(this,e,a)}}set(e,o){return this.value.set(e,o),new x(this,e,o)}has(e){if(e==="constructor"||this.value.has(e))return!0;let o=y(this.get("constructor"));if(!(o instanceof r))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let p=y(o.get("prototype"));if(!(p instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");return Q(p,e)!==null}delete(e){if(e==="prototype")throw new L("assignOfConstant");return this.value.delete(e)}apply(e,o){return this.caller(new Te(this,e,o))}construct(e){if(this===A.Number||this===A.String||this===A.Boolean||this===A.Array||this===A.Function||this===A.Object)return this.apply(new l(null),e);let o=this===A.Promise?new Y(new Promise(()=>{})):new M(new Map,this);return g(function*(){let p=yield this.apply(o,e);return p instanceof R?p:new m(o)}.bind(this))}toString(){return"<Lpp Function>"}};var E=class r extends I{constructor(e=[]){super();this.value=e}get(e){if(e==="constructor")return A.Array;{let o=parseInt(e,10);if(o>=0){let p=this.value[o];return p?new x(this,e,p):new x(this,e,new l(null))}else{let p=y(this.get("constructor"));if(!(p instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let s=y(p.get("prototype"));if(!(s instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");let a=Q(s,e);if(a===null)throw new L("invalidIndex");return new x(this,e,a)}}}set(e,o){let p=parseInt(e,10);if(p>=0)return this.value[p]=o,new x(this,e,o);throw new L("invalidIndex")}has(e){if(e==="constructor")return!0;let o=parseInt(e,10);if(o>=0&&o in this.value)return!0;let p=y(this.get("constructor"));if(!(p instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let s=y(p.get("prototype"));if(!(s instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");return Q(s,e)!==null}delete(e){let o=parseInt(e,10);return o>=0&&o in this.value?(delete this.value[o],!0):!1}instanceof(e){return e===A.Array}toString(){return"<Lpp Array>"}calc(e,o){if(o)switch(e){case"=":throw new L("assignOfConstant");case"+":return o instanceof r?new r(this.value.concat(o.value)):new l(NaN);case"*":{if(o instanceof l&&(typeof o.value=="boolean"||typeof o.value=="number")){let p=typeof o.value=="boolean"?+o.value:o.value;if(Number.isInteger(p)){let s=new r;for(let a=0;a<p;a++)s.value=s.value.concat(this.value);return s}}return new l(NaN)}case"==":return new l(X(this,o));case"!=":return new l(!X(this,o));case">":case"<":case">=":case"<=":return new l(le(this,e,o));case"&&":case"||":{let p=z(this),s=z(o);return new l(e==="&&"?p&&s:p||s)}case"instanceof":{if(o instanceof w)return new l(this.instanceof(o));throw new L("notCallable")}case"-":case"/":case"%":case"<<":case">>":case">>>":case"&":case"|":case"^":return new l(NaN)}else switch(e){case"delete":throw new L("assignOfConstant");case"!":return new l(!z(this));case"+":case"-":case"~":return new l(NaN)}throw new Error("lpp: unknown operand")}};var l=class r extends I{constructor(e){super();this._value=e}get value(){return this._value}get(e){if(this.value===null)throw new L("accessOfNull");if(e==="constructor")switch(typeof this.value){case"string":return A.String;case"number":return A.Number;case"boolean":return A.Boolean}else{if(e==="prototype")return new r(null);{if(typeof this.value=="string"){let a=parseInt(e);if(!isNaN(a)){let i=this.value[a];return i!==void 0?new r(i):new r(null)}}let o=y(this.get("constructor"));if(!(o instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let p=y(o.get("prototype"));if(!(p instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");let s=Q(p,e);return s===null?new r(null):new x(this,e,s)}}}set(){throw new L("assignOfConstant")}has(e){if(this.value===null)throw new L("accessOfNull");if(e==="constructor")return!0;let o=y(this.get("constructor"));if(!(o instanceof w))throw new Error("lpp: unexpected constructor -- must be a LppFunction instance");let p=y(o.get("prototype"));if(!(p instanceof M))throw new Error("lpp: unexpected prototype -- must be a LppObject instance");return Q(p,e)!==null}delete(){throw this.value===null?new L("accessOfNull"):new L("assignOfConstant")}instanceof(e){if(this.value===null)return!1;switch(typeof this.value){case"string":return e===A.String;case"number":return e===A.Number;case"boolean":return e===A.Boolean}}toString(){return`${this.value}`}calc(e,o){if(o)switch(e){case"=":throw new L("assignOfConstant");case"+":return this.value!==null&&o instanceof r&&o.value!==null?new r(ye(this,e,o)):new r(NaN);case"*":{if(this.value!==null){if(o instanceof r){if(typeof this.value=="string"&&typeof o.value=="number"){if(Number.isInteger(o.value))return new r(this.value.repeat(o.value))}else if(typeof this.value=="number"&&typeof o.value=="string"&&Number.isInteger(this.value))return new r(o.value.repeat(this.value));return new r(ye(this,e,o))}else if(o instanceof E&&(typeof this.value=="boolean"||typeof this.value=="number")){let p=typeof this.value=="boolean"?+this.value:this.value;if(Number.isInteger(p)){let s=new E;for(let a=0;a<p;a++)s.value=s.value.concat(o.value);return s}}}return new r(NaN)}case"==":return new r(X(this,o));case"!=":return new r(!X(this,o));case">":case"<":case">=":case"<=":return new r(le(this,e,o));case"&&":case"||":{let p=z(this),s=z(o);return new r(e==="&&"?p&&s:p||s)}case"-":case"/":case"%":case"<<":case">>":case">>>":case"&":case"|":case"^":return!(o instanceof r)||this.value===null||o.value===null||typeof this.value=="string"||typeof o.value=="string"?new r(NaN):new r(ye(this,e,o));case"instanceof":{if(o instanceof w)return new r(this.instanceof(o));throw new L("notCallable")}}else switch(e){case"delete":throw new L("assignOfConstant");case"+":return typeof this.value=="boolean"||typeof this.value=="number"||typeof this.value=="string"?new r(+this.value):new r(NaN);case"-":return typeof this.value=="boolean"||typeof this.value=="number"||typeof this.value=="string"?new r(-this.value):new r(NaN);case"!":return new r(!z(this));case"~":{if(!(typeof this.value=="boolean"||typeof this.value=="number"||typeof this.value=="string"))return new r(NaN);let p=+this.value;return isNaN(p)?new r(NaN):new r(~p)}}throw new Error("lpp: unknown operand")}};var x=class{constructor(t,e,o){this.name=e;this.value=o;this.parent=new WeakRef(t)}parent;get(t){return this.value.get(t)}set(t,e){return this.value.set(t,e)}has(t){return this.value.has(t)}delete(t){let e=this.parent.deref();if(!e)throw new L("assignOfConstant");return t?this.value.delete(t):e.delete(this.name)}instanceof(t){return this.value.instanceof(t)}assign(t){let e=this.parent.deref();if(!e)throw new L("assignOfConstant");return e.set(this.name,t),this.value=t,this}toString(){return this.value.toString()}calc(t,e){return t==="="&&e?this.assign(e):t==="delete"&&!e?new l(this.delete()):this.value.calc(t,e)}};var m=class{constructor(t){this.value=t;this.value=t}},R=class{constructor(t){this.value=t;this.stack=[]}stack;pushStack(t){this.stack.push(t)}},ee;(e=>{class r{}e.Base=r;class t extends r{constructor(s,a,i){super();this.fn=s;this.self=a;this.args=i}toString(){return"<Native Function>"}}e.NativeFn=t})(ee||={});var he=class extends I{value=new Map;get(t){return new x(this,t,this.value.get(t)??new l(null))}set(t,e){return this.value.set(t,e),new x(this,t,e)}has(t){return this.value.has(t)}delete(t){return this.value.delete(t)}instanceof(){throw new Error("lpp: invalid usage of instanceof on LppClosure")}toString(){return"<Lpp Closure>"}calc(){throw new Error("lpp: invalid usage of calc on LppClosure")}constructor(){super()}},te=class{constructor(t,e,o){this.parent=t;this._returnCallback=e;this._exceptionCallback=o;this.closure=new he,this.parent=t}closure=new he;exceptionCallback(t){this._exceptionCallback(t),this.clearCallbacks()}returnCallback(t){this._returnCallback(t),this.clearCallbacks()}get(t){return this.closure.has(t)?this.closure.get(t):this.parent?this.parent.get(t):this.closure.get(t)}clearCallbacks(){this._exceptionCallback=()=>{},this._returnCallback=()=>{}}unwind(){return this.parent?this.parent.unwind():null}},ce=class extends te{constructor(e,o,p,s){super(e,p,s);this.self=o}unwind(){return this}};function Fe(r){r.Array=w.native(({args:t})=>{function e(o){return o.length<1?new E:o.length===1&&o[0]instanceof E?o[0]:new E(o)}return new m(e(t))},new M(new Map([["length",w.native(({self:t})=>t instanceof E?new m(new l(t.value.length)):g(function*(){return j(yield r.IllegalInvocationError.construct([]))}))],["slice",w.native(({self:t,args:e})=>g(function*(){if(!(t instanceof E))return j(yield r.IllegalInvocationError.construct([]));let o=e[0],p=e[0];return o&&!(o instanceof l)||p&&!(p instanceof l)?j(yield r.IllegalInvocationError.construct([])):new m(new E(t.value.slice(o?.value??void 0,p?.value??void 0)))}))],["map",w.native(({self:t,args:e})=>g(function*(){if(!(t instanceof E)||!(e[0]instanceof w))return j(yield r.IllegalInvocationError.construct([]));let o=new E,p=e[0];for(let[s,a]of t.value.entries()){let i=yield p.apply(t,[a??new l(null),new l(s)]);if(i instanceof R)return i;o.value.push(i.value)}return new m(o)}))],["every",w.native(({self:t,args:e})=>g(function*(){if(!(t instanceof E)||!(e[0]instanceof w))return j(yield r.IllegalInvocationError.construct([]));let o=e[0];for(let[p,s]of t.value.entries()){let a=yield o.apply(t,[s??new l(null),new l(p)]);if(a instanceof R)return a;if(!z(a.value))return new m(new l(!1))}return new m(new l(!0))}))],["any",w.native(({self:t,args:e})=>g(function*(){if(!(t instanceof E)||!(e[0]instanceof w))return j(yield r.IllegalInvocationError.construct([]));let o=e[0];for(let[p,s]of t.value.entries()){let a=yield o.apply(t,[s??new l(null),new l(p)]);if(a instanceof R)return a;if(z(a.value))return new m(new l(!0))}return new m(new l(!1))}))]])))}function Qe(r){r.Boolean=w.native(({args:t})=>t.length<1?new m(new l(!1)):new m(new l(z(t[0]))),new M(new Map))}function Ge(r){r.Number=w.native(({args:t})=>{function e(o){if(o.length<1)return new l(0);let p=o[0];if(p instanceof l){if(p===new l(null))return new l(0);switch(typeof p.value){case"string":return new l(globalThis.Number(p.value));case"number":return new l(p.value);case"boolean":return p.value?new l(1):new l(0)}}else{if(p instanceof w)return new l(NaN);if(p instanceof M)return new l(NaN)}return new l(NaN)}return new m(e(t))},new M(new Map)),r.Number.set("EPLISON",new l(globalThis.Number.EPSILON)),r.Number.set("MAX_VALUE",new l(globalThis.Number.MAX_VALUE)),r.Number.set("MAX_SAFE_INTEGER",new l(globalThis.Number.MAX_SAFE_INTEGER)),r.Number.set("MIN_VALUE",new l(globalThis.Number.MIN_VALUE)),r.Number.set("MIN_SAFE_INTEGER",new l(globalThis.Number.MIN_SAFE_INTEGER)),r.Number.set("isNaN",w.native(({args:t})=>new m(new l(t.length>0&&t[0]instanceof l&&globalThis.Number.isNaN(t[0].value))))),r.Number.set("isFinite",w.native(({args:t})=>new m(new l(t.length>0&&t[0]instanceof l&&globalThis.Number.isFinite(t[0].value))))),r.Number.set("isSafeInteger",w.native(({args:t})=>new m(new l(t.length>0&&t[0]instanceof l&&globalThis.Number.isSafeInteger(t[0].value))))),r.Number.set("isSafeInteger",w.native(({args:t})=>new m(new l(t.length>0&&t[0]instanceof l&&globalThis.Number.isSafeInteger(t[0].value)))))}function Ye(r){r.Object=w.native(({args:t})=>{function e(o){return o.length<1?new M:o[0]}return new m(e(t))},new M(new Map))}function We(r){r.String=w.native(({args:t})=>{function e(o){if(o.length<1)return new l("");let p=o[0];return new l(p.toString())}return new m(e(t))},new M(new Map([["length",w.native(({self:t})=>t instanceof l&&typeof t.value=="string"?new m(new l(t.value.length)):g(function*(){return j(yield r.IllegalInvocationError.construct([]))}))]])))}function $e(r){r.Function=w.native(({args:t})=>t.length<1?new m(new w(()=>new m(new l(null)))):t[0]instanceof w?new m(t[0]):g(function*(){return j(yield r.IllegalInvocationError.construct([]))}),new M(new Map([["prototype",y(r.Object.get("prototype"))],["bind",w.native(({self:t,args:e})=>{if(!(t instanceof w)||e.length<1)return g(function*(){return j(yield r.IllegalInvocationError.construct([]))});let o=e[0];return new m(new w(p=>t.apply(o,p.args)))})]])))}function Lt(r,t){return r.pm=t.pm,new m(new l(null))}function Ze(r){r.Promise=w.native(({self:t,args:e})=>{if(t instanceof Y&&e.length>0&&e[0]instanceof w){let o=e[0];return g(function*(){return Lt(t,yield Y.generate((p,s)=>g(function*(){yield o.apply(t,[new w(({args:a})=>g(function*(){return yield K(new m(a[0]??new l(null)),p,s),new m(new l(null))})),new w(({args:a})=>(s(a[0]??new l(null)),new m(new l(null))))])})))})}else return g(function*(){return j(yield r.IllegalInvocationErrorError.construct([]))})},new M(new Map([["then",w.native(({self:t,args:e})=>t instanceof Y?new m(t.done(e[0]instanceof w?e[0]:void 0,e[1]instanceof w?e[1]:void 0)):g(function*(){return j(yield r.IllegalInvocationErrorError.construct([]))}))],["catch",w.native(({self:t,args:e})=>t instanceof Y&&e.length>0&&e[0]instanceof w?new m(t.error(e[0])):g(function*(){return j(yield r.IllegalInvocationErrorError.construct([]))}))]]))),r.Promise.set("resolve",w.native(({args:t})=>g(function*(){return new m(yield Y.generate((e,o)=>g(function*(){yield K(new m(t[0]??new l(null)),e,o)})))}))),r.Promise.set("reject",w.native(({args:t})=>new m(new Y(globalThis.Promise.reject(t[0]??new l(null))))))}function He(r){Ge(r),Qe(r),We(r),Fe(r),Ye(r),$e(r),Ze(r)}function _e(r){let t=r.Error=w.native(({self:e,args:o})=>e.instanceof(t)?(e.set("value",o[0]??new l(null)),e.set("stack",new l(null)),new m(new E)):g(function*(){return j(yield r.IllegalInvocationError.construct([]))}),new M(new Map))}function Je(r){let t=r.IllegalInvocationError=w.native(({self:e,args:o})=>e.instanceof(t)?g(function*(){let p=yield r.Error.apply(e,o);return p instanceof R?p:new m(new l(null))}):g(function*(){return j(yield t.construct([]))}),new M(new Map([["prototype",y(r.Error.get("prototype"))]])))}function Xe(r){let t=r.SyntaxError=w.native(({self:e,args:o})=>e.instanceof(t)?g(function*(){let p=yield r.Error.apply(e,o);return p instanceof R?p:new m(new l(null))}):g(function*(){return j(yield r.IllegalInvocationError.construct([]))}),new M(new Map([["prototype",y(r.Error.get("prototype"))]])))}function Ke(r){_e(r),Je(r),Xe(r)}var ie={};me(ie,{fromObject:()=>Ae,toObject:()=>Ce});function Ce(r){let t=new WeakMap;function e(o){if(o instanceof l)return o.value;if(o instanceof E){let p=t.get(o);if(p)return p;let s=o.value.map(a=>a?e(a):null);return t.set(o,s),s}if(o instanceof M){let p=t.get(o);if(p)return p;let s={};for(let[a,i]of o.value.entries())a!=="constructor"&&(s[a]=e(i));return t.set(o,s),s}return null}return e(r)}function Ae(r){let t=new WeakMap;function e(o){if(o==null)return new l(null);switch(typeof o){case"string":case"number":case"boolean":return new l(o);case"object":{let p=t.get(o);if(p)return p;if(o instanceof globalThis.Array){let a=new E(o.map(i=>e(i)));return t.set(o,a),a}let s=new M;for(let[a,i]of globalThis.Object.entries(o))s.set(a,e(i));return t.set(o,s),s}}return new l(null)}return e(r)}function qe(r){r.JSON=new M(new Map([["parse",w.native(({args:t})=>{if(t.length<1||!(t[0]instanceof l)||typeof t[0].value!="string")return g(function*(){return j(yield r.SyntaxError.construct([new l("Invalid JSON")]))});try{return new m(Ae(globalThis.JSON.parse(t[0].value)))}catch(e){return g(function*(){if(e instanceof globalThis.Error)return j(yield r.SyntaxError.construct([new l(e.message)]));throw e})}})],["stringify",w.native(({args:t})=>{if(t.length<1)return g(function*(){return j(yield r.SyntaxError.construct([new l("Invalid value")]))});try{return new m(new l(globalThis.JSON.stringify(Ce(t[0]))))}catch(e){return g(function*(){if(e instanceof globalThis.Error)return j(yield r.SyntaxError.construct([new l(e.message)]));throw e})}})]]))}function et(r){r.Math=new M(new Map([["E",new l(globalThis.Math.E)],["PI",new l(globalThis.Math.PI)],["sin",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.sin(t[0].value))))],["sinh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.sinh(t[0].value))))],["asin",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.asin(t[0].value))))],["asinh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.asinh(t[0].value))))],["cos",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.cos(t[0].value))))],["cosh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.cosh(t[0].value))))],["acos",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.acos(t[0].value))))],["acosh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.acosh(t[0].value))))],["tan",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.tan(t[0].value))))],["tanh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.tanh(t[0].value))))],["atan",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.atan(t[0].value))))],["atanh",w.native(({args:t})=>t.length<1||!(t[0]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.atanh(t[0].value))))],["atan2",w.native(({args:t})=>t.length<2||!(t[0]instanceof l)||typeof t[0].value!="number"||!(t[1]instanceof l)||typeof t[0].value!="number"?new m(new l(NaN)):new m(new l(globalThis.Math.atan2(t[0].value,t[1].value))))],["random",w.native(()=>new m(new l(globalThis.Math.random())))]]))}var Me={};He(Me);Ke(Me);qe(Me);et(Me);var A=Me;var D=A;var Oe="1.0.0";var nt=["\u{1F43A} @FurryR https://github.com/FurryR - Developer, Test, Translation, Documentation","\u{1F914} @SimonShiki https://github.com/SimonShiki - Test, Technical support","\u{1F604} @Nights https://github.com/Nightre - Technical support","\u{1F524} @CST1229 https://github.com/CST1229 - Technical support","\u2B50 @DilemmaGX https://github.com/DilemmaGX - Icon artist (legacy)","\u{1F36D} @TangDo158 https://github.com/TangDo158 - Icon artist (new)","\u{1F43A} @VeroFess https://github.com/VeroFess - Technical support"];var rt={"lpp.name":"lpp","lpp.documentation":"Open documentation","lpp.documentation.url":"https://github.com/FurryR/lpp-scratch/blob/main/README.md","lpp.block.construct.Number":"Number","lpp.block.construct.String":"String","lpp.block.construct.Function":"function","lpp.block.operator.var":"var","lpp.block.operator.self":"self","lpp.block.statement.return":"return","lpp.block.statement.throw":"throw","lpp.block.statement.scope":"scope","lpp.block.statement.try.1":"try","lpp.block.statement.try.2":"catch","lpp.error.useAfterDispose.summary":"Cannot operate sprite on a disposed target.","lpp.error.useAfterDispose.detail":"This error happens when you call a function which belongs to a disposed target, whose sprite is operated on. Please review your code.","lpp.error.useOutsideFunction.summary":"Cannot use this block outside a function context.","lpp.error.useOutsideFunction.detail":"Please note that this block must be used in function contexts.","lpp.error.useOutsideContext.summary":"Cannot use this block outside a lpp context.","lpp.error.useOutsideContext.detail":'Please create a lpp context use "scope" block first.',"lpp.error.syntaxError.summary":"Syntax error.","lpp.error.syntaxError.detail":"You used the block incorrectly. Please recheck if you used Scratch literals directly or misused expand operator.","lpp.error.accessOfNull.summary":"Invalid access of null.","lpp.error.accessOfNull.detail":"Please validate the object before you use.","lpp.error.assignOfConstant.summary":"Assigning to a constant is not allowed.","lpp.error.assignOfConstant.detail":"Please note that you cannot assign a value to a constant.","lpp.error.invalidIndex.summary":"Invalid index.","lpp.error.invalidIndex.detail":"Please note that you cannot use complex objects like Array, Object or Function as index.","lpp.error.notCallable.summary":"Object is not callable.","lpp.error.notCallable.detail":"Please note that you can only call Function objects.","lpp.error.recursivePrototype.summary":"Recursive prototype is not allowed.","lpp.error.recursivePrototype.detail":"Please resolve recursive dependency.","lpp.error.uncaughtException.summary":"Uncaught exception.","lpp.error.uncaughtException.detail":"Please use try-catch block to catch exceptions or the code will stop execution.","lpp.error.uncaughtException.exception":"Exception:","lpp.error.uncaughtException.traceback":"Traceback:","lpp.error.releaseMode.summary":"The code encountered an error while running.","lpp.error.releaseMode.detail":"The program may not work as intended. Please contact project maintainers with this message for help.","lpp.error.blockNotFound":"Unable to find the block in Blockly workspace. The block might not belong to the target that you are currently editing.","lpp.error.position":"Position:","lpp.error.context":"Context:","lpp.error.self":"Self:","lpp.error.arguments":"Arguments:","lpp.error.hint":"For further information please check DevTools Console.","lpp.category.builtin":"Builtin","lpp.category.construct":"Construction","lpp.category.operator":"Operator","lpp.category.statement":"Statement","lpp.tooltip.builtin.type":"Predefined builtin data types. Includes everything which language feature requires.","lpp.tooltip.builtin.error":"Predefined builtin error types. Includes all errors which builtin classes throw.","lpp.tooltip.builtin.utility":"Predefined builtin utility types. Includes methods to process data.","lpp.tooltip.construct.literal":"Construct special literals in lpp.","lpp.tooltip.construct.Number":"Construct a Number object by Scratch literal.","lpp.tooltip.construct.String":"Construct a String object by Scratch literal.","lpp.tooltip.construct.Array":'Construct an Array object with specified structure. Use "+" to add or "-" to remove an element.',"lpp.tooltip.construct.Object":'Construct an Object object with specified structure. Use "+" to add or "-" to remove an element.',"lpp.tooltip.construct.Function":'Construct an Function object. Use "+" to add or "-" to remove an argument.',"lpp.tooltip.operator.get":"Get specified member of specified object.","lpp.tooltip.operator.binaryOp":"Do binary operations.","lpp.tooltip.operator.unaryOp":"Do unary operations.","lpp.tooltip.operator.call":'Call function with given arguments. Use "+" to add or "-" to remove an argument.',"lpp.tooltip.operator.new":'Construct an instance with given constructor and arguments. Use "+" to add or "-" to remove an argument.',"lpp.tooltip.operator.self":"Get the reference of self object in function context.","lpp.tooltip.operator.var":"Get the reference of a specified local variable or an argument.","lpp.tooltip.statement.return":"Return a value from the function.","lpp.tooltip.statement.throw":"Throw a value. It will interrupt current control flow immediately.","lpp.tooltip.statement.scope":"Create a lpp scope and execute the code in it.","lpp.tooltip.statement.try":"Try capturing exceptions in specified statements. If an exception is thrown, set the specified reference to error object, then execute exception handling code.","lpp.tooltip.statement.nop":"Does nothing. It is used to convert a Scratch reporter into a statement.","lpp.tooltip.button.close":"Close this hint.","lpp.tooltip.button.help.more":"Show detail.","lpp.tooltip.button.help.less":"Hide detail.","lpp.tooltip.button.scrollToBlockEnabled":"Scroll to this block.","lpp.tooltip.button.scrollToBlockDisabled":"Unable to find this block in project.","lpp.tooltip.button.nativeFn":"This is native function. For further information please check DevTools Console.","lpp.about.summary":"lpp is a high-level programming language developed by @FurryR.","lpp.about.github":"GitHub repository","lpp.about.afdian":"Sponsor","lpp.about.staff.1":"lpp developers staff","lpp.about.staff.2":"lpp won't be created without their effort."};var ot={"lpp.name":"lpp","lpp.documentation":"\u6253\u5F00\u6587\u6863","lpp.documentation.url":"https://github.com/FurryR/lpp-scratch/blob/main/README-zh_CN.md","lpp.block.construct.Number":"\u6570\u5B57","lpp.block.construct.String":"\u5B57\u7B26\u4E32","lpp.block.construct.Function":"\u51FD\u6570","lpp.block.operator.var":"\u53D8\u91CF","lpp.block.operator.self":"\u81EA\u8EAB","lpp.block.statement.return":"\u8FD4\u56DE","lpp.block.statement.throw":"\u629B\u51FA","lpp.block.statement.scope":"\u4F5C\u7528\u57DF","lpp.block.statement.try.1":"\u5C1D\u8BD5","lpp.block.statement.try.2":"\u6355\u83B7","lpp.error.useAfterDispose.summary":"\u65E0\u6CD5\u5728\u5DF2\u9500\u6BC1\u7684\u76EE\u6807\u4E0A\u64CD\u4F5C\u89D2\u8272\u3002","lpp.error.useAfterDispose.detail":"\u5982\u679C\u60A8\u8C03\u7528\u4E00\u4E2A\u5C5E\u4E8E\u5DF2\u9500\u6BC1\u89D2\u8272\u7684\u51FD\u6570\u5E76\u5728\u5176\u4E0A\u64CD\u4F5C\u89D2\u8272\uFF0C\u5219\u4F1A\u53D1\u751F\u6B64\u9519\u8BEF\u3002\u8BF7\u68C0\u67E5\u60A8\u7684\u4EE3\u7801\u3002","lpp.error.useOutsideFunction.summary":"\u65E0\u6CD5\u5728\u51FD\u6570\u4E4B\u5916\u4F7F\u7528\u6B64\u79EF\u6728\u3002","lpp.error.useOutsideFunction.detail":"\u8BF7\u6CE8\u610F\u4E00\u5B9A\u8981\u5728\u51FD\u6570\u5185\u4F7F\u7528\u6B64\u7C7B\u79EF\u6728\u3002","lpp.error.useOutsideContext.summary":"\u65E0\u6CD5\u5728 lpp \u4E0A\u4E0B\u6587\u4EE5\u5916\u4F7F\u7528\u6B64\u79EF\u6728\u3002","lpp.error.useOutsideContext.detail":"\u8BF7\u9996\u5148\u4F7F\u7528\u4F5C\u7528\u57DF\u79EF\u6728\u6765\u521B\u5EFA\u4F5C\u7528\u57DF\u3002","lpp.error.syntaxError.summary":"\u79EF\u6728\u8BED\u6CD5\u9519\u8BEF\u3002","lpp.error.syntaxError.detail":"\u60A8\u9519\u8BEF\u5730\u4F7F\u7528\u4E86\u79EF\u6728\u3002\u8BF7\u91CD\u65B0\u68C0\u67E5\u662F\u5426\u6709\u76F4\u63A5\u4F7F\u7528 Scratch \u5B57\u9762\u91CF\u6216\u9519\u8BEF\u4F7F\u7528\u5C55\u5F00\u8FD0\u7B97\u7B26\u7684\u60C5\u51B5\u3002","lpp.error.accessOfNull.summary":"\u8BBF\u95EE\u4E86 null \u7684\u6210\u5458\u3002","lpp.error.accessOfNull.detail":"\u8BF7\u5728\u4F7F\u7528\u5BF9\u8C61\u524D\u68C0\u67E5\u5BF9\u8C61\u662F\u5426\u4E3A\u7A7A\u3002","lpp.error.assignOfConstant.summary":"\u5BF9\u5E38\u91CF\u8FDB\u884C\u4E86\u8D4B\u503C\u64CD\u4F5C\u3002","lpp.error.assignOfConstant.detail":"\u60A8\u53EF\u80FD\u6DF7\u6DC6\u4E86\u5DE6\u503C\u548C\u53F3\u503C\u3002\u8BF7\u6CE8\u610F\u60A8\u65E0\u6CD5\u5BF9\u53F3\u503C\u8FDB\u884C\u8D4B\u503C\u64CD\u4F5C\u3002","lpp.error.invalidIndex.summary":"\u5BF9\u8C61\u4E0B\u6807\u65E0\u6548\u3002","lpp.error.invalidIndex.detail":"\u8BF7\u6CE8\u610F\u8BF8\u5982 Array\uFF0CObject\uFF0CFunction \u7B49\u590D\u6742\u6570\u636E\u7C7B\u578B\u65E0\u6CD5\u4F5C\u4E3A\u4E0B\u6807\u4F7F\u7528\u3002","lpp.error.notCallable.summary":"\u5BF9\u8C61\u4E0D\u53EF\u8C03\u7528\u3002","lpp.error.notCallable.detail":"\u60A8\u4E0D\u53EF\u8C03\u7528\u9664\u4E86 Function \u7C7B\u578B\u4EE5\u5916\u7684\u5BF9\u8C61\u3002","lpp.error.recursivePrototype.summary":"\u5FAA\u73AF\u4F9D\u8D56 prototype \u4E0D\u88AB\u5141\u8BB8\u3002","lpp.error.recursivePrototype.detail":"\u8BF7\u89E3\u51B3\u5FAA\u73AF\u4F9D\u8D56\u3002","lpp.error.uncaughtException.summary":"\u6709\u672A\u88AB\u6355\u83B7\u7684\u5F02\u5E38\u3002","lpp.error.uncaughtException.detail":"\u8BF7\u4F7F\u7528\u5C1D\u8BD5/\u6355\u83B7\u79EF\u6728\u5BF9\u9519\u8BEF\u8FDB\u884C\u6355\u83B7\uFF0C\u5426\u5219\u4EE3\u7801\u5C06\u7EC8\u6B62\u8FD0\u884C\u3002","lpp.error.uncaughtException.exception":"\u9519\u8BEF\u5185\u5BB9\uFF1A","lpp.error.uncaughtException.traceback":"\u6808\u56DE\u6EAF\uFF1A","lpp.error.releaseMode.summary":"\u4EE3\u7801\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u53D1\u751F\u9519\u8BEF\u3002","lpp.error.releaseMode.detail":"\u7A0B\u5E8F\u53EF\u80FD\u65E0\u6CD5\u6309\u9884\u671F\u6B63\u5E38\u8FD0\u884C\u3002\u8BF7\u8054\u7CFB\u9879\u76EE\u7EF4\u62A4\u8005\u4EE5\u83B7\u5F97\u5E2E\u52A9\u3002\u8BF7\u6CE8\u610F\u540C\u65F6\u9644\u4E0A\u6B64\u6D88\u606F\u3002","lpp.error.blockNotFound":"\u65E0\u6CD5\u5728 Blockly \u5DE5\u4F5C\u533A\u4E2D\u627E\u5230\u79EF\u6728\u3002\u8BE5\u79EF\u6728\u53EF\u80FD\u5E76\u4E0D\u5C5E\u4E8E\u5F53\u524D\u6B63\u7F16\u8F91\u7684\u89D2\u8272\u3002","lpp.error.position":"\u4F4D\u7F6E\uFF1A","lpp.error.context":"\u4E0A\u4E0B\u6587\uFF1A","lpp.error.self":"\u81EA\u8EAB\uFF1A","lpp.error.arguments":"\u53C2\u6570\uFF1A","lpp.error.hint":"\u8BE6\u7EC6\u5185\u5BB9\u5728 DevTools Console \u5185\u3002","lpp.category.builtin":"\u5185\u5D4C","lpp.category.construct":"\u6784\u9020","lpp.category.operator":"\u8FD0\u7B97","lpp.category.statement":"\u8BED\u53E5","lpp.tooltip.builtin.type":"\u9884\u5B9A\u4E49\u7684\u5185\u5D4C\u6570\u636E\u7C7B\u578B\u3002\u5305\u542B\u4E86\u8BED\u8A00\u7279\u6027\u6240\u9700\u8981\u7684\u5168\u90E8\u7C7B\u3002","lpp.tooltip.builtin.error":"\u9884\u5B9A\u4E49\u7684\u5185\u5D4C\u9519\u8BEF\u7C7B\u578B\u3002\u5305\u542B\u4E86\u8BED\u8A00\u5185\u5D4C\u7C7B\u4F1A\u629B\u51FA\u7684\u5168\u90E8\u9519\u8BEF\u3002","lpp.tooltip.builtin.utility":"\u9884\u5B9A\u4E49\u7684\u5B9E\u7528\u5DE5\u5177\u7C7B\u578B\u3002\u5305\u542B\u4E86\u5904\u7406\u6570\u636E\u9700\u8981\u7684\u5404\u79CD\u65B9\u6CD5\u3002","lpp.tooltip.construct.literal":"\u6784\u9020 lpp \u4E2D\u7279\u6B8A\u7684\u5B57\u9762\u91CF\u3002","lpp.tooltip.construct.Number":"\u4EE5 Scratch \u5B57\u9762\u91CF\u6784\u9020\u4E00\u4E2A Number \u5BF9\u8C61\u3002","lpp.tooltip.construct.String":"\u4EE5 Scratch \u5B57\u9762\u91CF\u6784\u9020\u4E00\u4E2A String \u5BF9\u8C61\u3002","lpp.tooltip.construct.Array":"\u4EE5\u6307\u5B9A\u7ED3\u6784\u6784\u9020 Array \u5BF9\u8C61\u3002\u53EF\u4F7F\u7528\u201C+\u201D\u6216\u201C-\u201D\u5BF9\u5143\u7D20\u8FDB\u884C\u589E\u51CF\u3002","lpp.tooltip.construct.Object":"\u4EE5\u6307\u5B9A\u7ED3\u6784\u6784\u9020 Object \u5BF9\u8C61\u3002\u53EF\u4F7F\u7528\u201C+\u201D\u6216\u201C-\u201D\u5BF9\u5143\u7D20\u8FDB\u884C\u589E\u51CF\u3002","lpp.tooltip.construct.Function":"\u6784\u9020 Function \u5BF9\u8C61\u3002\u53EF\u4F7F\u7528\u201C+\u201D\u6216\u201C-\u201D\u5BF9\u53C2\u6570\u8FDB\u884C\u589E\u51CF\u3002","lpp.tooltip.operator.get":"\u83B7\u5F97\u5BF9\u8C61\u4E0B\u7684\u67D0\u4E2A\u6210\u5458\u3002","lpp.tooltip.operator.binaryOp":"\u8FDB\u884C\u4E8C\u5143\u8FD0\u7B97\u3002","lpp.tooltip.operator.unaryOp":"\u8FDB\u884C\u4E00\u5143\u8FD0\u7B97\u3002","lpp.tooltip.operator.call":"\u4EE5\u7ED9\u5B9A\u7684\u53C2\u6570\u8C03\u7528\u51FD\u6570\u3002\u53EF\u4F7F\u7528\u201C+\u201D\u6216\u201C-\u201D\u5BF9\u53C2\u6570\u8FDB\u884C\u589E\u51CF\u3002","lpp.tooltip.operator.new":"\u4EE5\u6307\u5B9A\u7684\u53C2\u6570\u548C\u6784\u9020\u5668\u6784\u9020\u4E00\u4E2A\u5B9E\u4F8B\u3002\u53EF\u4F7F\u7528\u201C+\u201D\u6216\u201C-\u201D\u5BF9\u53C2\u6570\u8FDB\u884C\u589E\u51CF\u3002","lpp.tooltip.operator.self":"\u83B7\u5F97 Function \u5BF9\u8C61\u4E0A\u4E0B\u6587\u4E2D\u81EA\u8EAB\u7684\u5F15\u7528\u3002","lpp.tooltip.operator.var":"\u83B7\u5F97\u5F53\u524D\u4F5C\u7528\u57DF\u4E2D\u5C40\u90E8\u53D8\u91CF\u6216\u53C2\u6570\u7684\u5F15\u7528\u3002","lpp.tooltip.statement.return":"\u4ECE\u51FD\u6570\u8FD4\u56DE\u4E00\u4E2A\u503C\u3002","lpp.tooltip.statement.throw":"\u629B\u51FA\u4E00\u4E2A\u503C\u3002\u8FD9\u5C06\u7ACB\u5373\u4E2D\u65AD\u5F53\u524D\u63A7\u5236\u6D41\u3002","lpp.tooltip.statement.scope":"\u65B0\u5EFA lpp \u4F5C\u7528\u57DF\uFF0C\u5E76\u5728\u4F5C\u7528\u57DF\u5185\u6267\u884C\u4EE3\u7801\u3002","lpp.tooltip.statement.try":"\u5C1D\u8BD5\u5728\u6307\u5B9A\u7684\u8BED\u53E5\u5757\u4E2D\u6355\u83B7\u9519\u8BEF\u3002\u82E5\u6709\u9519\u8BEF\u88AB\u629B\u51FA\uFF0C\u5C06\u6307\u5B9A\u7684\u53D8\u91CF\u5F15\u7528\u8D4B\u503C\u4E3A\u9519\u8BEF\u5BF9\u8C61\uFF0C\u7136\u540E\u6267\u884C\u9519\u8BEF\u5904\u7406\u4EE3\u7801\u3002","lpp.tooltip.statement.nop":"\u65E0\u4EFB\u4F55\u6548\u679C\u3002\u7528\u4E8E\u5C06\u8FD4\u56DE\u503C\u79EF\u6728\u8F6C\u6362\u4E3A\u8BED\u53E5\u3002","lpp.tooltip.button.close":"\u5173\u95ED\u8FD9\u4E2A\u63D0\u793A\u3002","lpp.tooltip.button.help.more":"\u663E\u793A\u8BE6\u7EC6\u4FE1\u606F\u3002","lpp.tooltip.button.help.less":"\u9690\u85CF\u8BE6\u7EC6\u4FE1\u606F\u3002","lpp.tooltip.button.scrollToBlockEnabled":"\u8F6C\u5230\u8FD9\u4E2A\u79EF\u6728\u3002","lpp.tooltip.button.scrollToBlockDisabled":"\u65E0\u6CD5\u5728\u9879\u76EE\u4E2D\u627E\u5230\u6B64\u79EF\u6728\u3002","lpp.tooltip.button.nativeFn":"\u8FD9\u662F\u539F\u751F\u51FD\u6570\u3002\u8BE6\u7EC6\u5185\u5BB9\u5728 DevTools Console \u5185\u3002","lpp.about.summary":"lpp \u662F\u7531 @FurryR \u5F00\u53D1\u7684\u9AD8\u7EA7\u7A0B\u5E8F\u8BBE\u8BA1\u8BED\u8A00\u3002","lpp.about.github":"\u672C\u9879\u76EE\u7684 GitHub \u4ED3\u5E93","lpp.about.afdian":"\u8D5E\u52A9\u8005","lpp.about.staff.1":"lpp \u5F00\u53D1\u8005\u540D\u5355","lpp.about.staff.2":"\u5982\u679C\u6CA1\u6709\u4ED6/\u5979\u4EEC\uFF0Clpp \u5C06\u4E0D\u590D\u5B58\u5728\u3002"};var it={en:rt,"zh-cn":ot};var O={};me(O,{CloseIcon:()=>ve,Div:()=>gt,HelpIcon:()=>xe,IconGroup:()=>De,Text:()=>ke,Title:()=>be,globalStyle:()=>ne,show:()=>Ne});function Ne(r,t,e,o){let p=r.getMainWorkspace(),s=p.getBlockById(t);if(!s)return;r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent();let a=r.DropDownDiv.getContentDiv(),i=document.createElement("div");return i.setAttribute("class","valueReportBox"),i.append(...e),i.style.maxWidth="none",i.style.maxHeight="none",i.style.textAlign=o,i.style.userSelect="none",a.appendChild(i),r.DropDownDiv.setColour(r.Colours.valueReportBackground,r.Colours.valueReportBorder),r.DropDownDiv.showPositionedByBlock(p,s),i}function De(r){let t=document.createElement("div");return t.style.float="right",t.append(...r),t}function ve(r,t){let e=document.createElement("span");return e.classList.add("lpp-traceback-icon"),e.addEventListener("click",()=>{r.DropDownDiv.hide()}),e.title=`\u274C ${t}`,e.textContent="\u274C",e}function xe(r,t,e,o){let p=!1,s=document.createElement("span");return s.classList.add("lpp-traceback-icon"),s.textContent="\u2753",s.title=`\u2753 ${r}`,s.addEventListener("click",()=>{p?(s.textContent="\u2753",s.title=`\u2753 ${r}`,o()):(s.textContent="\u2796",s.title=`\u2796 ${t}`,e()),p=!p}),s}function be(r){let t=document.createElement("div");return t.style.textAlign="left",t.style.whiteSpace="nowrap",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.title=t.textContent=r,t}function ke(r,t){let e=document.createElement("span");return t&&(e.className=t),e.textContent=r,e}function gt(r,t){let e=document.createElement("div");return t&&(e.className=t),e.append(...r),e}var ne=document?document.createElement("style"):void 0;ne&&(ne.id="lpp-traceback-style",ne.textContent=`
.lpp-traceback-icon {
  transition: text-shadow 0.25s ease-out;
  color: transparent;
  text-shadow: 0 0 0 gray;
}
.lpp-traceback-icon:hover {
  cursor: pointer;
  text-shadow: 0 0 0 gray, 0px 0px 5px silver;
}
`,document.head.appendChild(ne));var Z;(o=>{o.Base=ee.Base,o.NativeFn=ee.NativeFn;class e extends ee.Base{constructor(a,i,n){super();this.target=a;this.block=i;this.context=n}toString(){return this.block}}o.Block=e})(Z||={});var Be={};me(Be,{TypeMetadata:()=>q,attach:()=>ue,hasMetadata:()=>re});var q=class{constructor(t){this.signature=t}};function re(r){return!!r.metadata}function ue(r,t){let e=r;return e.metadata=t,e}var H=class extends q{constructor(e,o,p,s,a){super(e);this.blocks=o;this.sprite=p;this.target=s;this.closure=a}};function st(r,t){function e(p,s){let a={};a[s.id]=structuredClone(s);for(let i of Object.values(s.inputs)){let n=p.getBlock(i.block);n&&Object.assign(a,e(p,n))}if(s.next){let i=p.getBlock(s.next);i&&Object.assign(a,e(p,i))}return a}let o=e(r,t);return o[t.id].parent=null,o}function at(r,t){r._blocks=t}var Re;(p=>{function r(s){if(!(typeof s=="object"&&s!==null))return!1;let a=s;return!(a.id!==null&&typeof a.id!="string"||typeof a.name!="string"||typeof a.value!="string")}p.isField=r;function t(s,a){if(!(typeof a=="object"&&a!==null))return!1;let i=a;return!(i.shadow!==null&&typeof i.shadow!="string"||typeof i.name!="string"||typeof i.block!="string"||!(i.block in s))}p.isInput=t;function e(s,a,i){if(!(typeof i=="object"&&i!==null))return!1;let n=i;return!(n.id!==a||typeof n.opcode!="string"||n.parent!==null&&(typeof n.parent!="string"||!(n.parent in s)||n.parent===a)||n.next!==null&&(typeof n.next!="string"||!(n.next in s)||n.next===a)||typeof n.shadow!="boolean"||typeof n.topLevel!="boolean"||!(typeof n.inputs=="object"&&n.inputs!==null)||!Object.values(n.inputs).every(u=>t(s,u))&&Object.keys(n.inputs).length!==0||!(typeof n.fields=="object"&&n.fields!==null)||!Object.values(n.fields).every(u=>r(u))&&Object.keys(n.fields).length!==0||n.mutation!==void 0&&!(typeof n.mutation=="object"&&n.mutation!==null))}p.isBlock=e;function o(s){if(!(typeof s=="object"&&s!==null))return!1;let a=s;return!(!(a.signature instanceof Array)||!a.signature.every(i=>typeof i=="string")&&a.signature.length!==0||!(typeof a.script=="object"&&a.script!==null)||!Object.entries(a.script).every(i=>e(a.script,i[0],i[1]))&&Object.keys(a.script).length!==0||typeof a.block!="string"||!(a.block in a.script))}p.isInfo=o})(Re||={});var U=class{constructor(t){this.value=t}toString(){return"<Lpp BoundArg>"}};function de(r,t,e,o){function p(a,i,n,u){let d=!1,c=document.createElement("span");return c.classList.add("lpp-traceback-icon"),c.textContent="\u2795",c.title=`\u2795 ${a}`,c.addEventListener("click",()=>{d?(c.textContent="\u2795",c.title=`\u2795 ${a}`,u()):(c.textContent="\u2796",c.title=`\u2796 ${i}`,n()),d=!d}),c}function s(a){function i(d,c,f){let h=document.createElement("li");return h.append(f?O.Text(d,"lpp-code lpp-inspector-number lpp-inspector-key"):/^[$_a-zA-Z][$_0-9a-zA-Z]*$/.test(d)?O.Text(d,`lpp-code lpp-inspector-key${["constructor","prototype"].includes(String(d))?`-${d}`:""}`):O.Text(JSON.stringify(d),"lpp-code lpp-inspector-string lpp-inspector-key"),O.Text(" \u27A1\uFE0F ")),h.append(de(r,t,e,c)),h}let n=(a instanceof M||a instanceof w)&&re(a),u=document.createElement("ul");u.classList.add("lpp-list");for(let[d,c]of a.value.entries())(!(a instanceof w)||d!=="prototype")&&d!=="constructor"&&u.append(i(String(d),c??new l(null),a instanceof E||a instanceof U));if(a instanceof w&&u.append(i("prototype",a.value.get("prototype")??new l(null),!1)),(a instanceof E||a instanceof w||a instanceof M)&&u.append(i("constructor",a instanceof E?D.Array:a.value.get("constructor")??(a instanceof w?D.Function:D.Object),!1)),n&&a.metadata instanceof H){let d=document.createElement("li");d.append(O.Text("[[FunctionLocation]]","lpp-code lpp-inspector-key-constructor"),O.Text(" \u27A1\uFE0E "));let c=document.createElement("span");if(c.classList.add("lpp-code"),r&&a.metadata.sprite&&t.runtime.getTargetById(a.metadata.sprite)){let f=r.getMainWorkspace();c.classList.add("lpp-traceback-stack-enabled");let{sprite:h,blocks:T}=a.metadata;c.textContent=T[1],c.title=e("lpp.tooltip.button.scrollToBlockEnabled"),c.addEventListener("click",()=>{let v=r.DropDownDiv.getContentDiv().getElementsByClassName("valueReportBox")[0];t.setEditingTarget(h),f.centerOnBlock(T[1],!0),v&&(r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent(),r.DropDownDiv.getContentDiv().append(v),r.DropDownDiv.showPositionedByBlock(f,f.getBlockById(T[1])))})}else c.classList.add("lpp-inspector-null"),c.textContent="null";d.append(c),u.append(d)}return u}if(o instanceof l){if(o.value===null)return O.Text("null","lpp-code lpp-inspector-null");switch(typeof o.value){case"boolean":case"number":return O.Text(String(o.value),"lpp-code lpp-inspector-number");case"string":return O.Text(JSON.stringify(o.value),"lpp-code lpp-inspector-string")}}else if(o instanceof E||o instanceof M||o instanceof w||o instanceof U){let a,i=p(e("lpp.tooltip.button.help.more"),e("lpp.tooltip.button.help.less"),()=>{a?a.style.display="block":n.appendChild(a=s(o))},()=>{a&&(a.style.display="none")}),n=document.createElement("span");n.style.lineHeight="80%";let u;if(o instanceof E?u=O.Text(o.value.length===0?"[]":"[...]","lpp-code"):o instanceof w?(u=O.Text(`f (${re(o)&&o.metadata instanceof q?o.metadata.signature.join(", "):""})`,"lpp-code"),u.style.fontStyle="italic"):o instanceof M?u=O.Text(o.value.size===0?"{}":"{...}","lpp-code"):u=O.Text(o.value.length===0?"()":"(...)","lpp-code"),r&&(o instanceof w||o instanceof M)&&re(o)&&o.metadata instanceof H&&o.metadata.sprite&&t.runtime.getTargetById(o.metadata.sprite)){let d=r.getMainWorkspace(),{sprite:c,blocks:f}=o.metadata;u.title=e("lpp.tooltip.button.scrollToBlockEnabled"),u.classList.add("lpp-traceback-stack-enabled"),u.addEventListener("click",()=>{let h=r.DropDownDiv.getContentDiv().getElementsByClassName("valueReportBox")[0];t.setEditingTarget(c),d.centerOnBlock(f[1],!0),h&&(r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent(),r.DropDownDiv.getContentDiv().append(h),r.DropDownDiv.showPositionedByBlock(d,d.getBlockById(f[1])))})}else u.addEventListener("click",()=>{i.click()});return n.append(i,O.Text(" "),u),n}throw new Error("lpp: unknown value")}O.globalStyle&&(O.globalStyle.textContent+=`
.lpp-inspector-null {
  color: gray;
  user-select: text;
}
.lpp-inspector-key {
  font-weight: bold;
  user-select: text;
}
.lpp-inspector-key-prototype {
  font-weight: bold;
  color: gray;
  user-select: text;
}
.lpp-inspector-key-constructor {
  color: gray;
  user-select: text;
}
.lpp-inspector-number {
  color: blue;
  user-select: text;
}
.lpp-inspector-string {
  color: green;
  user-select: text;
}
`);var fe;function Le({title:r,body:t,tag:e,silent:o}){Notification.requestPermission().then(p=>{p==="granted"&&(fe?(fe.close(),fe=void 0,setTimeout(()=>Le({title:r,body:t,tag:e,silent:o}))):(fe=new Notification(r,{body:t,tag:e,silent:o}),fe.addEventListener("close",()=>{fe=void 0})))})}function pt(r){let t=document.getElementById("tmpSVGContainer"),e=r.outerHTML.replace(/&nbsp;/g," ");t||(t=document.createElement("div"),t.id="tmpSVGContainer",t.innerHTML='<svg id="tmpSVG" xmlns="http://www.w3.org/2000/svg" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="blocklySvg"><style type="text/css" ><![CDATA[.blocklyDraggable{font-family: "Helvetica Neue", Helvetica, sans-serif;font-size: 12pt;font-weight: 500;}.blocklyText {fill: #fff;box-sizing: border-box;}.blocklyEditableText .blocklyText{fill: #000;}.blocklyDropdownText.blocklyText{fill: #fff;}]]></style><g id="tmpSVGContent"></g></svg>',document.body.appendChild(t));let o=document.getElementById("tmpSVGContent");if(o&&o instanceof SVGGElement){o.innerHTML=e,o.children[0].setAttribute("transform","");let p=o.children[0].getAttribute("data-shapes")??"",s=p.includes("hat"),a=p!=="hat"&&s,i=o.getBBox(),n=s?18:0;n=a?21:n;let u=Math.max(750,i.width+1),d=i.height+n,c=document.getElementById("tmpSVG");if(c){c.setAttribute("width",u.toString()),c.setAttribute("height",d.toString()),c.setAttribute("viewBox",`-1 ${s?-n:0} ${u} ${d}`);let f=c.outerHTML;f=(f=(f=(f=(f=f.replace(/"[\S]+?dropdown-arrow\.svg"/gm,'"data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4="')).replace(/"[\S]+?green-flag\.svg"/gm,'"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9ImdyZWVuZmxhZyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDI0IDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiM0NTk5M0Q7fQoJLnN0MXtmaWxsOiM0Q0JGNTY7fQo8L3N0eWxlPgo8dGl0bGU+Z3JlZW5mbGFnPC90aXRsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTIwLjgsMy43Yy0wLjQtMC4yLTAuOS0wLjEtMS4yLDAuMmMtMiwxLjYtNC44LDEuNi02LjgsMGMtMi4zLTEuOS01LjYtMi4zLTguMy0xVjIuNWMwLTAuNi0wLjUtMS0xLTEKCXMtMSwwLjQtMSwxdjE4LjhjMCwwLjUsMC41LDEsMSwxaDAuMWMwLjUsMCwxLTAuNSwxLTF2LTYuNGMxLTAuNywyLjEtMS4yLDMuNC0xLjNjMS4yLDAsMi40LDAuNCwzLjQsMS4yYzIuOSwyLjMsNywyLjMsOS44LDAKCWMwLjMtMC4yLDAuNC0wLjUsMC40LTAuOVY0LjdDMjEuNiw0LjIsMjEuMywzLjgsMjAuOCwzLjd6IE0yMC41LDEzLjlDMjAuNSwxMy45LDIwLjUsMTMuOSwyMC41LDEzLjlDMTgsMTYsMTQuNCwxNiwxMS45LDE0CgljLTEuMS0wLjktMi41LTEuNC00LTEuNGMtMS4yLDAuMS0yLjMsMC41LTMuNCwxLjFWNEM3LDIuNiwxMCwyLjksMTIuMiw0LjZjMi40LDEuOSw1LjcsMS45LDguMSwwYzAuMSwwLDAuMSwwLDAuMiwwCgljMCwwLDAuMSwwLjEsMC4xLDAuMUwyMC41LDEzLjl6Ii8+CjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0yMC42LDQuOGwtMC4xLDkuMWMwLDAsMCwwLjEsMCwwLjFjLTIuNSwyLTYuMSwyLTguNiwwYy0xLjEtMC45LTIuNS0xLjQtNC0xLjRjLTEuMiwwLjEtMi4zLDAuNS0zLjQsMS4xVjQKCUM3LDIuNiwxMCwyLjksMTIuMiw0LjZjMi40LDEuOSw1LjcsMS45LDguMSwwYzAuMSwwLDAuMSwwLDAuMiwwQzIwLjUsNC43LDIwLjYsNC43LDIwLjYsNC44eiIvPgo8L3N2Zz4K"')).replace(/"[\S]+?repeat\.svg"/gm,'"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9InJlcGVhdCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiCgkgdmlld0JveD0iMCAwIDI0IDI0IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgoJLnN0MHtmaWxsOiNDRjhCMTc7fQoJLnN0MXtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPgo8dGl0bGU+cmVwZWF0PC90aXRsZT4KPHBhdGggY2xhc3M9InN0MCIgZD0iTTIzLjMsMTFjLTAuMywwLjYtMC45LDEtMS41LDFoLTEuNmMtMC4xLDEuMy0wLjUsMi41LTEuMSwzLjZjLTAuOSwxLjctMi4zLDMuMi00LjEsNC4xCgljLTEuNywwLjktMy42LDEuMi01LjUsMC45Yy0xLjgtMC4zLTMuNS0xLjEtNC45LTIuM2MtMC43LTAuNy0wLjctMS45LDAtMi42YzAuNi0wLjYsMS42LTAuNywyLjMtMC4ySDdjMC45LDAuNiwxLjksMC45LDIuOSwwLjkKCXMxLjktMC4zLDIuNy0wLjljMS4xLTAuOCwxLjgtMi4xLDEuOC0zLjVoLTEuNWMtMC45LDAtMS43LTAuNy0xLjctMS43YzAtMC40LDAuMi0wLjksMC41LTEuMmw0LjQtNC40YzAuNy0wLjYsMS43LTAuNiwyLjQsMEwyMyw5LjIKCUMyMy41LDkuNywyMy42LDEwLjQsMjMuMywxMXoiLz4KPHBhdGggY2xhc3M9InN0MSIgZD0iTTIxLjgsMTFoLTIuNmMwLDEuNS0wLjMsMi45LTEsNC4yYy0wLjgsMS42LTIuMSwyLjgtMy43LDMuNmMtMS41LDAuOC0zLjMsMS4xLTQuOSwwLjhjLTEuNi0wLjItMy4yLTEtNC40LTIuMQoJYy0wLjQtMC4zLTAuNC0wLjktMC4xLTEuMmMwLjMtMC40LDAuOS0wLjQsMS4yLTAuMWwwLDBjMSwwLjcsMi4yLDEuMSwzLjQsMS4xczIuMy0wLjMsMy4zLTFjMC45LTAuNiwxLjYtMS41LDItMi42CgljMC4zLTAuOSwwLjQtMS44LDAuMi0yLjhoLTIuNGMtMC40LDAtMC43LTAuMy0wLjctMC43YzAtMC4yLDAuMS0wLjMsMC4yLTAuNGw0LjQtNC40YzAuMy0wLjMsMC43LTAuMywwLjksMEwyMiw5LjgKCWMwLjMsMC4zLDAuNCwwLjYsMC4zLDAuOVMyMiwxMSwyMS44LDExeiIvPgo8L3N2Zz4K"')).replace(/"[\S]+?rotate-left\.svg"/gm,'"data:image/svg+xml;base64,PHN2ZyBpZD0icm90YXRlLWNsb2Nrd2lzZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMjQgMjQiPjxkZWZzPjxzdHlsZT4uY2xzLTF7ZmlsbDojM2Q3OWNjO30uY2xzLTJ7ZmlsbDojZmZmO308L3N0eWxlPjwvZGVmcz48dGl0bGU+cm90YXRlLWNsb2Nrd2lzZTwvdGl0bGU+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMjAuMzQsMTguMjFhMTAuMjQsMTAuMjQsMCwwLDEtOC4xLDQuMjIsMi4yNiwyLjI2LDAsMCwxLS4xNi00LjUyaDBhNS41OCw1LjU4LDAsMCwwLDQuMjUtMi41Myw1LjA2LDUuMDYsMCwwLDAsLjU0LTQuNjJBNC4yNSw0LjI1LDAsMCwwLDE1LjU1LDlhNC4zMSw0LjMxLDAsMCwwLTItLjhBNC44Miw0LjgyLDAsMCwwLDEwLjQsOWwxLjEyLDEuNDFBMS41OSwxLjU5LDAsMCwxLDEwLjM2LDEzSDIuNjdhMS41NiwxLjU2LDAsMCwxLTEuMjYtLjYzQTEuNTQsMS41NCwwLDAsMSwxLjEzLDExTDIuODUsMy41N0ExLjU5LDEuNTksMCwwLDEsNC4zOCwyLjQsMS41NywxLjU3LDAsMCwxLDUuNjIsM0w2LjcsNC4zNWExMC42NiwxMC42NiwwLDAsMSw3LjcyLTEuNjhBOS44OCw5Ljg4LDAsMCwxLDE5LDQuODEsOS42MSw5LjYxLDAsMCwxLDIxLjgzLDksMTAuMDgsMTAuMDgsMCwwLDEsMjAuMzQsMTguMjFaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMTkuNTYsMTcuNjVhOS4yOSw5LjI5LDAsMCwxLTcuMzUsMy44MywxLjMxLDEuMzEsMCwwLDEtLjA4LTIuNjIsNi41Myw2LjUzLDAsMCwwLDUtMi45Miw2LjA1LDYuMDUsMCwwLDAsLjY3LTUuNTEsNS4zMiw1LjMyLDAsMCwwLTEuNjQtMi4xNiw1LjIxLDUuMjEsMCwwLDAtMi40OC0xQTUuODYsNS44NiwwLDAsMCw5LDguODRMMTAuNzQsMTFhLjU5LjU5LDAsMCwxLS40MywxSDIuN2EuNi42LDAsMCwxLS42LS43NUwzLjgxLDMuODNhLjU5LjU5LDAsMCwxLDEtLjIxbDEuNjcsMi4xYTkuNzEsOS43MSwwLDAsMSw3Ljc1LTIuMDcsOC44NCw4Ljg0LDAsMCwxLDQuMTIsMS45Miw4LjY4LDguNjgsMCwwLDEsMi41NCwzLjcyQTkuMTQsOS4xNCwwLDAsMSwxOS41NiwxNy42NVoiLz48L3N2Zz4="')).replace(/"[\S]+?rotate-right\.svg"/gm,'"data:image/svg+xml;base64,PHN2ZyBpZD0icm90YXRlLWNvdW50ZXItY2xvY2t3aXNlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMzZDc5Y2M7fS5jbHMtMntmaWxsOiNmZmY7fTwvc3R5bGU+PC9kZWZzPjx0aXRsZT5yb3RhdGUtY291bnRlci1jbG9ja3dpc2U8L3RpdGxlPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTIyLjY4LDEyLjJhMS42LDEuNiwwLDAsMS0xLjI3LjYzSDEzLjcyYTEuNTksMS41OSwwLDAsMS0xLjE2LTIuNThsMS4xMi0xLjQxYTQuODIsNC44MiwwLDAsMC0zLjE0LS43Nyw0LjMxLDQuMzEsMCwwLDAtMiwuOCw0LjI1LDQuMjUsMCwwLDAtMS4zNCwxLjczLDUuMDYsNS4wNiwwLDAsMCwuNTQsNC42MkE1LjU4LDUuNTgsMCwwLDAsMTIsMTcuNzRoMGEyLjI2LDIuMjYsMCwwLDEtLjE2LDQuNTJBMTAuMjUsMTAuMjUsMCwwLDEsMy43NCwxOCwxMC4xNCwxMC4xNCwwLDAsMSwyLjI1LDguNzgsOS43LDkuNywwLDAsMSw1LjA4LDQuNjQsOS45Miw5LjkyLDAsMCwxLDkuNjYsMi41YTEwLjY2LDEwLjY2LDAsMCwxLDcuNzIsMS42OGwxLjA4LTEuMzVhMS41NywxLjU3LDAsMCwxLDEuMjQtLjYsMS42LDEuNiwwLDAsMSwxLjU0LDEuMjFsMS43LDcuMzdBMS41NywxLjU3LDAsMCwxLDIyLjY4LDEyLjJaIi8+PHBhdGggY2xhc3M9ImNscy0yIiBkPSJNMjEuMzgsMTEuODNIMTMuNzdhLjU5LjU5LDAsMCwxLS40My0xbDEuNzUtMi4xOWE1LjksNS45LDAsMCwwLTQuNy0xLjU4LDUuMDcsNS4wNywwLDAsMC00LjExLDMuMTdBNiw2LDAsMCwwLDcsMTUuNzdhNi41MSw2LjUxLDAsMCwwLDUsMi45MiwxLjMxLDEuMzEsMCwwLDEtLjA4LDIuNjIsOS4zLDkuMywwLDAsMS03LjM1LTMuODJBOS4xNiw5LjE2LDAsMCwxLDMuMTcsOS4xMiw4LjUxLDguNTEsMCwwLDEsNS43MSw1LjQsOC43Niw4Ljc2LDAsMCwxLDkuODIsMy40OGE5LjcxLDkuNzEsMCwwLDEsNy43NSwyLjA3bDEuNjctMi4xYS41OS41OSwwLDAsMSwxLC4yMUwyMiwxMS4wOEEuNTkuNTksMCwwLDEsMjEuMzgsMTEuODNaIi8+PC9zdmc+"');let h=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(f)}`;document.body.removeChild(t),console.log("%c ",`font-size: 1px; padding-right: ${u}px; padding-bottom: ${d}px; background-image: url('${h}'); background-repeat: no-repeat; background-size: contain; color: transparent;`)}}}function lt(r,t,e,o,p,s){if(r){t.runtime.getEditingTarget()?.id!==s&&t.runtime.getTargetById(s)&&t.setEditingTarget(s),r.getMainWorkspace().centerOnBlock(p,!0);let i="",n=Ne(r,p,[De([xe(e("lpp.tooltip.button.help.more"),e("lpp.tooltip.button.help.less"),()=>{if(n){let u=n.getElementsByClassName("lpp-hint")[0];u&&(i=u.textContent??"",u.textContent=`\u{1F4A1} ${e(`lpp.error.${o}.detail`)}`)}},()=>{if(n){let u=n.getElementsByClassName("lpp-hint")[0];u&&(u.textContent=i)}}),ve(r,e("lpp.tooltip.button.close"))]),be(`\u2139\uFE0F ${e(`lpp.error.${o}.summary`)}`),document.createElement("br"),ke(`\u{1F50D} ${e("lpp.error.hint")}`,"lpp-hint")],"left");n||Le({title:`\u274C ${e(`lpp.error.${o}.summary`)}`,body:`\u{1F4CC} ${e("lpp.error.position")} ${p}
\u{1F50D} ${e("lpp.error.hint")}`,tag:"lppError",silent:!1})}else Le({title:`\u274C ${e("lpp.error.releaseMode.summary")}`,body:`\u2139\uFE0F ${e("lpp.error.releaseMode.detail")}
\u{1F50D} ${e("lpp.error.hint")}`,tag:"lppError",silent:!0});if(console.groupCollapsed(`\u274C ${e(`lpp.error.${o}.summary`)}`),r){console.log(`\u{1F4A1} ${e(`lpp.error.${o}.detail`)}`);let i=r.getMainWorkspace()?.getBlockById(p)?.getSvgRoot();console.groupCollapsed(`\u{1F4CC} ${e("lpp.error.position")} ${p}`),i?(pt(i),console.log(i)):console.log(`\u2753 ${e("lpp.error.blockNotFound")}`),console.groupEnd()}else console.log(`\u2139\uFE0F ${e("lpp.error.releaseMode.detail")}`),console.log(`\u{1F4CC} ${e("lpp.error.position")} ${p}`);console.groupEnd()}function ct(r,t,e,o){if(r){let p=()=>{let a=[];a.push(`\u{1F4A1} ${e("lpp.error.uncaughtException.detail")}`,document.createElement("br"),document.createElement("br")),a.push(`\u{1F914} ${e("lpp.error.uncaughtException.exception")}`,document.createElement("br"),de(r,t,e,o.value),document.createElement("br")),a.push(`\u{1F47E} ${e("lpp.error.uncaughtException.traceback")}`);let i=document.createElement("ul");i.classList.add("lpp-list");for(let[n,u]of o.stack.entries()){let d=document.createElement("li"),c=document.createElement("span");if(c.classList.add("lpp-code"),r&&u instanceof Z.Block)if(t.runtime.getTargetById(u.target)){let f=r.getMainWorkspace();c.classList.add("lpp-traceback-stack-enabled"),c.title=e("lpp.tooltip.button.scrollToBlockEnabled"),c.addEventListener("click",()=>{let h=r.DropDownDiv.getContentDiv().getElementsByClassName("valueReportBox")[0];t.setEditingTarget(u.target),f.centerOnBlock(u.block,!0),r.DropDownDiv.hideWithoutAnimation(),r.DropDownDiv.clearContent(),r.DropDownDiv.getContentDiv().append(h),r.DropDownDiv.showPositionedByBlock(f,f.getBlockById(u.block))})}else c.classList.add("lpp-traceback-stack-disabled"),c.title=e("lpp.tooltip.button.scrollToBlockDisabled");else u instanceof Z.NativeFn&&(c.title=e("lpp.tooltip.button.nativeFn"));c.textContent=u.toString(),d.append(`\u{1F4CC} ${n} \u27A1\uFE0F `,c),i.append(d)}return a.push(i),a},s=!1;for(let a of o.stack.toReversed())if(a instanceof Z.Block&&t.runtime.getTargetById(a.target)){t.setEditingTarget(a.target),r.getMainWorkspace().centerOnBlock(a.block,!0);let n="",u=Ne(r,a.block,[De([xe(e("lpp.tooltip.button.help.more"),e("lpp.tooltip.button.help.less"),()=>{if(u){let d=u.getElementsByClassName("lpp-hint")[0];if(d){for(n=d.textContent??"";d.firstChild;)d.removeChild(d.firstChild);d.append(...p())}}},()=>{if(u){let d=u.getElementsByClassName("lpp-hint")[0];d&&(d.textContent=n)}}),ve(r,e("lpp.tooltip.button.close"))]),be(`\u2139\uFE0F ${e("lpp.error.uncaughtException.summary")}`),document.createElement("br"),ke(`\u{1F50D} ${e("lpp.error.hint")}`,"lpp-hint")],"left");s=!!u;break}s||Le({title:`\u274C ${e("lpp.error.uncaughtException.summary")}`,body:`\u{1F4A1} ${e("lpp.error.uncaughtException.detail")}
\u{1F50D} ${e("lpp.error.hint")}`,tag:"lppError",silent:!1})}else Le({title:`\u274C ${e("lpp.error.releaseMode.summary")}`,body:`\u2139\uFE0F ${e("lpp.error.releaseMode.detail")}
\u{1F50D} ${e("lpp.error.hint")}`,tag:"lppError",silent:!0});console.groupCollapsed(`\u274C ${e("lpp.error.uncaughtException.summary")}`),console.log(r?`\u{1F4A1} ${e("lpp.error.uncaughtException.detail")}`:`\u2139\uFE0F ${e("lpp.error.releaseMode.detail")}`),console.log(`\u{1F914} ${e("lpp.error.uncaughtException.exception")}`,o.value),console.groupCollapsed(`\u{1F47E} ${e("lpp.error.uncaughtException.traceback")}`);for(let[p,s]of o.stack.entries())if(r)if(s instanceof Z.Block){let i=r.getMainWorkspace()?.getBlockById(s.block)?.getSvgRoot();console.groupCollapsed(`\u{1F4CC} ${p+1} \u27A1\uFE0F`,s.block),i?(pt(i),console.log(i)):console.log(`\u2753 ${e("lpp.error.blockNotFound")}`),s.context&&console.log(`\u{1F6E0}\uFE0F ${e("lpp.error.context")}`,s.context),console.groupEnd()}else s instanceof Z.NativeFn?(console.groupCollapsed(`\u{1F4CC} ${p+1} \u27A1\uFE0F`,s.fn),console.log(`\u{1F6E0}\uFE0F ${e("lpp.error.self")}`,s.self),console.log(`\u{1F6E0}\uFE0F ${e("lpp.error.arguments")}`,s.args),console.groupEnd()):console.log(`\u{1F4CC} ${p+1} \u27A1\uFE0F`,s.toString());else console.log(`\u{1F4CC} ${p+1} \u27A1\uFE0F`,s.toString());console.groupEnd(),console.groupEnd()}ne&&(ne.textContent+=`
.lpp-list {
  list-style-type: disc;
  padding: 0;
  margin-left: 19.5px;
  margin-top: 4px;
  margin-bottom: 0;
}
.lpp-list li {
  line-height: 100%;
  margin-top: 0;
  margin-bottom: 4px;
}
.lpp-code {
  font-family: "Source Code Pro", "Fira Code", "DejaVu Sans Mono", "Cascadia Code", "Jetbrains Mono", "Lucida Console", Consolas, monospace;
}
.lpp-traceback-stack-enabled {
  transition: color 0.25s ease-out;
}
.lpp-traceback-stack-disabled {
  transition: color 0.25s ease-out;
}
.lpp-traceback-stack-enabled:hover {
  cursor: pointer;
  color: gray;
  user-select: text;
}
.lpp-traceback-stack-disabled:hover {
  cursor: not-allowed;
  color: red;
  user-select: text;
}
`);var Ee=class{constructor(t,e){this.id=t;this.lazyText=e}inject(){}export(){return[{func:this.id,blockType:"button",text:this.lazyText()}]}},se=class{constructor(t){this.lazyLabel=t;this.block=new Map}block;inject(t,e){let o=p=>{p.setCategory(e.id),p.setInputsInline(!0),p.setColour(e.color)};for(let[p,s]of this.block.entries()){let a=s.init(t,null),i={};if(typeof a=="function")i.init=function(...n){return o(this),s.init(t,this)(...n)};else for(let n of Object.keys(a))i[n]=function(...u){return n==="init"&&o(this),s.init(t,this)[n].apply(window,u)};Reflect.defineProperty(t.Blocks,`${e.id}_${p}`,{get(){return i},set(){},configurable:!0})}}register(t,e){return this.block.set(t,e),this}export(){return[{blockType:"label",text:this.lazyLabel()}].concat(Array.from(this.block.entries()).map(([t,e])=>({blockType:e.type,opcode:t,text:"",arguments:{}})))}},Ie=class{constructor(t,e){this.id=t;this.color=e}blocks=[];register(t){return this.blocks.push(t),this}inject(t){for(let e of this.blocks)e.inject(t,this)}export(){return this.blocks.map(t=>t.export()).flat(1)}};function ut(r,t){let e=(o,p)=>{p.setOutput(!0,"String"),p.setOutputShape(t==="square"?o.OUTPUT_SHAPE_SQUARE:o.OUTPUT_SHAPE_ROUND)};return{init(o,p){let s=r(o,p);if(typeof s=="function")return(...a)=>(e(o,p),s(...a));if(s.init){let a=s.init;s.init=(...i)=>(e(o,p),a(...i))}return s},type:"reporter"}}function we(r,t=!1){let e=(o,p)=>{p.setNextStatement(!t),p.setPreviousStatement(!0),p.setOutputShape(o.OUTPUT_SHAPE_SQUARE)};return{init(o,p){let s=r(o,p);if(typeof s=="function")return(...a)=>(e(o,p),s(...a));if(s.init){let a=s.init;s.init=(...i)=>(e(o,p),a(...i))}return s},type:"command"}}var V;(e=>{function r(o){return ut(o,"square")}e.Square=r;function t(o){return ut(o,"round")}e.Round=t})(V||={});var N={};me(N,{Any:()=>vt,Statement:()=>xt,String:()=>Dt,Text:()=>dt});function Tt(r,t){let e=document.createElement("shadow"),o=document.createElement("field");return e.setAttribute("type","text"),o.setAttribute("name","TEXT"),o.textContent=t,e.appendChild(o),r.connection.setShadowDom(e),r.connection.respawnShadow_(),r}function Nt(r){return r.connection.setShadowDom(null),r.connection.respawnShadow_(),r}function Dt(r,t,e){let o=r.appendValueInput(t),p=r.workspace;return r.isInsertionMarker()||p.currentGesture_?.isDraggingBlock_&&p.currentGesture_?.targetBlock_?.type===r.type?o:Tt(o,e)}function vt(r,t){let e=r.appendValueInput(t),o=r.workspace;return r.isInsertionMarker()||o.currentGesture_?.isDraggingBlock_&&o.currentGesture_?.targetBlock_?.type===r.type?e:Nt(e)}function dt(r,t,e){if(typeof e=="string")return dt(r,t,[e]);let o=r.appendDummyInput(t);return e.forEach(p=>o.appendField(p)),o}function xt(r,t){return r.appendStatementInput(t)}function _(r){return typeof r.length=="number"}var ft=(()=>{let r;return function(e){let o=e,p=e.FieldImage;return r??(r=class extends p{constructor(i,n,u,d,c,f,h){super(i,n,u,c,f);this.callback=d;this.padding=h}init(){if(this.fieldGroup_)return;super.init(),this.mouseDownWrapper_=o.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_);let i=this.getSvgRoot();i&&(i.style.cursor="pointer")}showEditor_(){this.callback&&this.callback()}getSize(){return this.size_.width||this.render_(),this.padding?this.size_:new this.size_.constructor(Math.max(1,this.size_.width-o.BlockSvg.SEP_SPACE_X),this.size_.height)}EDITABLE=!0})}})(),bt="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",kt="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K";function wt(r,t,e){let o=(i,n)=>{let u=ft(i);return new u(bt,15,15,()=>{if(i.Events.setGroup(!0),n.mutationToDom&&n.domToMutation){let d=n.mutationToDom(),c=i.Xml.domToText(d),f=d.getAttribute("length");f!==null&&d.setAttribute("length",String(parseInt(f,10)+1)),n.domToMutation(d),n.initSvg(),n.render(),i.Events.fire(new i.Events.BlockChange(n,"mutation","length",c,i.Xml.domToText(n.mutationToDom())))}i.Events.setGroup(!1)},"+",!1,!0)},p=(i,n)=>{let u=ft(i);return new u(kt,15,15,()=>{if(i.Events.setGroup(!0),n.mutationToDom&&n.domToMutation){let d=n.mutationToDom(),c=i.Xml.domToText(d),f=d.getAttribute("length");f!==null&&d.setAttribute("length",String(Math.max(0,parseInt(f,10)-1))),n.domToMutation(d),n.initSvg(),n.render(),i.Events.fire(new i.Events.BlockChange(n,"mutation","length",c,i.Xml.domToText(n.mutationToDom())))}i.Events.setGroup(!1)},"-",!1,!0)},s=(i,n)=>{if(n.length!==void 0){n.removeInput("MINUS",!0),n.removeInput("PLUS",!0);let u=n.inputList[0]?.name;n.appendDummyInput("PLUS").appendField(o(i,n)),u&&n.moveInputBefore("PLUS",u),n.length>0&&(n.appendDummyInput("MINUS").appendField(p(i,n)),u&&n.moveInputBefore("MINUS",u))}},a=i=>{let n=t.getEditingTarget(),u=n?.blocks.getBlock(i.id);if(!u||!n)return;let d=new Set(i.inputList.map(f=>f.name)),c=u.inputs;for(let f of Object.keys(c)){let h=c[f];if(!d.has(f)){let T=n.blocks;T.deleteBlock(h.block),T.deleteBlock(h.shadow),delete c[f]}}};return new Ie("lpp",r).register(new Ee("documentation",()=>`\u{1F4C4} ${e("lpp.documentation")}`)).register(new se(()=>`#\uFE0F\u20E3 ${e("lpp.category.builtin")}`).register("builtinType",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.builtin.type")),n.appendDummyInput().appendField(new i.FieldDropdown([["Boolean","Boolean"],["Number","Number"],["String","String"],["Array","Array"],["Object","Object"],["Function","Function"],["Promise","Promise"]]),"value")})).register("builtinError",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.builtin.error")),n.appendDummyInput().appendField(new i.FieldDropdown([["Error","Error"],["IllegalInvocationError","IllegalInvocationError"],["SyntaxError","SyntaxError"]]),"value")})).register("builtinUtility",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.builtin.error")),n.appendDummyInput().appendField(new i.FieldDropdown([["JSON","JSON"],["Math","Math"]]),"value")}))).register(new se(()=>`\u{1F6A7} ${e("lpp.category.construct")}`).register("constructLiteral",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.construct.literal")),n.appendDummyInput().appendField(new i.FieldDropdown([["null","null"],["true","true"],["false","false"],["NaN","NaN"],["Infinity","Infinity"]]),"value")})).register("constructNumber",V.Square((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.construct.Number")),N.Text(n,"BEGIN",[e("lpp.block.construct.Number"),"("]),N.String(n,"value","10"),N.Text(n,"END",")")})).register("constructString",V.Square((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.construct.String")),N.Text(n,"BEGIN",[e("lpp.block.construct.String"),"("]),N.String(n,"value","\u{1F31F}"),N.Text(n,"END",")")})).register("constructArray",V.Square((i,n)=>({init(){n.setTooltip(e("lpp.tooltip.construct.Array"));let u=n;N.Text(n,"BEGIN","["),N.Text(n,"END","]"),u.length=0,s(i,u)},mutationToDom(){let u=document.createElement("mutation");return _(n)&&u.setAttribute("length",String(n.length)),u},domToMutation(u){let d=parseInt(u.getAttribute("length")??"0",10);if(_(n)){if(d>n.length)for(let c=n.length;c<d;c++)c>0&&(n.appendDummyInput(`COMMA_${c}`).appendField(","),n.moveInputBefore(`COMMA_${c}`,"END")),N.Any(n,`ARG_${c}`),n.moveInputBefore(`ARG_${c}`,"END");else{for(let c=d;c<n.length;c++)n.removeInput(`ARG_${c}`,!0),n.removeInput(`COMMA_${c}`,!0);a(n)}n.length=d,s(i,n)}}}))).register("constructObject",V.Square((i,n)=>({init(){n.setTooltip(e("lpp.tooltip.construct.Object"));let u=n;N.Text(n,"BEGIN","{"),N.Text(n,"END","}"),u.length=0,s(i,u)},mutationToDom(){let u=document.createElement("mutation");return _(n)&&u.setAttribute("length",String(n.length)),u},domToMutation(u){let d=parseInt(u.getAttribute("length")??"0",10);if(_(n)){if(d>n.length)for(let c=n.length;c<d;c++)c>0&&(n.appendDummyInput(`COMMA_${c}`).appendField(","),n.moveInputBefore(`COMMA_${c}`,"END")),N.String(n,`KEY_${c}`,""),N.Text(n,`COLON_${c}`,":"),N.Any(n,`VALUE_${c}`),n.moveInputBefore(`VALUE_${c}`,"END"),n.moveInputBefore(`COLON_${c}`,`VALUE_${c}`),n.moveInputBefore(`KEY_${c}`,`COLON_${c}`);else{for(let c=d;c<n.length;c++)n.removeInput(`KEY_${c}`,!0),n.removeInput(`COLON_${c}`,!0),n.removeInput(`VALUE_${c}`,!0),n.removeInput(`COMMA_${c}`,!0);a(n)}n.length=d,s(i,n)}}}))).register("constructFunction",V.Square((i,n)=>({init(){n.setTooltip(e("lpp.tooltip.construct.Function"));let u=n;N.Text(n,"BEGIN",[e("lpp.block.construct.Function"),"("]),N.Text(n,"END",")"),N.Statement(n,"SUBSTACK"),u.length=0,s(i,u)},mutationToDom(){let u=document.createElement("mutation");return _(n)&&u.setAttribute("length",String(n.length)),u},domToMutation(u){let d=parseInt(u.getAttribute("length")??"0",10);if(_(n)){if(d>n.length)for(let c=n.length;c<d;c++)c>0&&(n.appendDummyInput(`COMMA_${c}`).appendField(","),n.moveInputBefore(`COMMA_${c}`,"END")),N.String(n,`ARG_${c}`,""),n.moveInputBefore(`ARG_${c}`,"END");else{for(let c=d;c<n.length;c++)n.removeInput(`ARG_${c}`,!0),n.removeInput(`COMMA_${c}`,!0);a(n)}n.length=d,s(i,n)}}})))).register(new se(()=>`\u{1F522} ${e("lpp.category.operator")}`).register("binaryOp",V.Square((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.operator.binaryOp")),N.String(n,"lhs",""),n.appendDummyInput().appendField(new i.FieldDropdown([["=","="],[".","."],["+","+"],["-","-"],["*","*"],["/","/"],["%","%"],["==","=="],["!=","!="],[">",">"],["<","<"],[">=",">="],["<=","<="],["&&","&&"],["||","||"],["<<","<<"],[">>",">>"],[">>>",">>>"],["&","&"],["|","|"],["^","^"],["instanceof","instanceof"],["in","in"]]),"op"),N.String(n,"rhs","")})).register("unaryOp",V.Square((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.operator.unaryOp")),n.appendDummyInput().appendField(new i.FieldDropdown([["+","+"],["-","-"],["!","!"],["~","~"],["...","..."],["delete","delete"],["await","await"],["yield","yield"],["yield*","yield*"]]),"op"),N.Any(n,"value")})).register("new",V.Square((i,n)=>({init(){n.setTooltip(e("lpp.tooltip.operator.new"));let u=n;N.Text(n,"LABEL","new"),N.Any(n,"fn"),N.Text(n,"BEGIN","("),N.Text(n,"END",")"),u.length=0,s(i,u)},mutationToDom(){let u=document.createElement("mutation");return _(n)&&u.setAttribute("length",String(n.length)),u},domToMutation(u){let d=parseInt(u.getAttribute("length")??"0",10);if(_(n)){if(d>n.length)for(let c=n.length;c<d;c++)c>0&&(n.appendDummyInput(`COMMA_${c}`).appendField(","),n.moveInputBefore(`COMMA_${c}`,"END")),N.Any(n,`ARG_${c}`),n.moveInputBefore(`ARG_${c}`,"END");else{for(let c=d;c<n.length;c++)n.removeInput(`ARG_${c}`,!0),n.removeInput(`COMMA_${c}`,!0);a(n)}n.length=d,s(i,n)}}}))).register("call",V.Square((i,n)=>({init(){n.setTooltip(e("lpp.tooltip.operator.call"));let u=n;N.Any(n,"fn"),N.Text(n,"BEGIN","("),N.Text(n,"END",")"),u.length=0,s(i,u)},mutationToDom(){let u=document.createElement("mutation");return _(n)&&u.setAttribute("length",String(n.length)),u},domToMutation(u){let d=parseInt(u.getAttribute("length")??"0",10);if(_(n)){if(d>n.length)for(let c=n.length;c<d;c++)c>0&&(n.appendDummyInput(`COMMA_${c}`).appendField(","),n.moveInputBefore(`COMMA_${c}`,"END")),N.Any(n,`ARG_${c}`),n.moveInputBefore(`ARG_${c}`,"END");else{for(let c=d;c<n.length;c++)n.removeInput(`ARG_${c}`,!0),n.removeInput(`COMMA_${c}`,!0);a(n)}n.length=d,s(i,n)}}}))).register("self",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.operator.self")),n.setCheckboxInFlyout(!1),N.Text(n,"LABEL",e("lpp.block.operator.self"))})).register("var",V.Round((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.operator.var")),N.Text(n,"LABEL",e("lpp.block.operator.var")),N.String(n,"name","\u{1F43A}")}))).register(new se(()=>`\u{1F916} ${e("lpp.category.statement")}`).register("return",we((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.statement.return")),N.Text(n,"LABEL",e("lpp.block.statement.return")),N.Any(n,"value")},!0)).register("throw",we((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.statement.throw")),N.Text(n,"LABEL",e("lpp.block.statement.throw")),N.Any(n,"value")},!0)).register("scope",we((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.statement.scope")),N.Text(n,"LABEL",e("lpp.block.statement.scope")),N.Statement(n,"SUBSTACK")})).register("try",we((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.statement.try")),N.Text(n,"TRY",e("lpp.block.statement.try.1")),N.Statement(n,"SUBSTACK"),N.Text(n,"CATCH",e("lpp.block.statement.try.2")),N.Any(n,"var"),N.Statement(n,"SUBSTACK_2")})).register("nop",we((i,n)=>()=>{n.setTooltip(e("lpp.tooltip.statement.nop")),N.Any(n,"value")})))}var S=class r extends String{constructor(e){super(e);this.value=e}static unwrap(e){return e instanceof r?e.value:e}toString(){return String(this.value)}};function mt(){function r(t,e){let o=y(t);o instanceof w&&ue(o,new q(e))}r(D.Number,["value?"]),r(D.Boolean,["value?"]),r(D.String,["value?"]),r(D.Array,["value?"]),r(D.Object,["value?"]),r(D.Function,["value?"]),r(D.Array.get("prototype").get("map"),["predict"]),r(D.Array.get("prototype").get("every"),["predict"]),r(D.Array.get("prototype").get("any"),["predict"]),r(D.Array.get("prototype").get("slice"),["start?","end?"]),r(D.Function.get("prototype").get("bind"),["self"]),r(D.Function.get("deserialize"),["obj"]),r(D.Function.get("serialize"),["fn"]),r(D.Promise,["executor"]),r(D.Promise.get("prototype").get("then"),["onfulfilled?","onrejected?"]),r(D.Promise.get("resolve"),["value?"]),r(D.Promise.get("reject"),["reason?"]),r(D.Promise.get("prototype").get("catch"),["onrejected"]),r(D.JSON.get("parse"),["json"]),r(D.JSON.get("stringify"),["value"]),r(D.Math.get("sin"),["x"]),r(D.Math.get("sinh"),["x"]),r(D.Math.get("asin"),["x"]),r(D.Math.get("asinh"),["x"]),r(D.Math.get("cos"),["x"]),r(D.Math.get("cosh"),["x"]),r(D.Math.get("acos"),["x"]),r(D.Math.get("acosh"),["x"]),r(D.Math.get("tan"),["x"]),r(D.Math.get("tanh"),["x"]),r(D.Math.get("atan"),["x"]),r(D.Math.get("atanh"),["x"]),r(D.Math.get("atan2"),["x","y"])}var W=class{constructor(t){this.value=t}},ge=class{constructor(t){this.reason=t}handled=!1},b=Symbol("PromiseResult"),ae=Symbol("PromiseCallback"),$=class r{get[Symbol.toStringTag](){return"ImmediatePromise"}[ae]=[];[b];constructor(t){let e=p=>{let s=a=>{this[b]||(this[b]=new W(a),this[ae].forEach(i=>i()),this[ae]=[])};J(p)?p.then(a=>{s(a)},a=>{o(a)}):s(p)},o=p=>{if(!this[b]){let s=new ge(p);this[b]=s,this[ae].forEach(a=>a()),this[ae]=[],setTimeout(()=>{if(!s.handled)throw s.reason})}};if(typeof t!="function")throw new TypeError(`Promise resolver ${t} is not a function`);try{t(e,o)}catch(p){o(p)}}then(t,e){return new r((o,p)=>this[b]?this[b]instanceof W?o(t?t(this[b].value):this[b].value):(this[b].handled=!0,e?o(e(this[b].reason)):p(this[b].reason)):void this[ae].push(()=>{try{this[b]instanceof W?o(t?t(this[b].value):this[b].value):this[b]instanceof ge&&(this[b].handled=!0,e?o(e(this[b].reason)):p(this[b].reason))}catch(s){p(s)}}))}catch(t){return this.then(void 0,t)}finally(t){return t?new r((e,o)=>{if(this[b]){let p=t();return J(p)?void p.then(()=>this[b]&&(this[b]instanceof W?e(this[b].value):o(this[b].reason)),s=>o(s)):this[b]instanceof W?e(this[b].value):o(this[b].reason)}return void this[ae].push(()=>{if(this[b])try{let p=t();return J(p)?void p.then(()=>this[b]&&(this[b]instanceof W?e(this[b].value):o(this[b].reason)),s=>o(s)):this[b]instanceof W?e(this[b].value):o(this[b].reason)}catch(p){o(p)}})}):this}static all(t){return new r((e,o)=>{let p=0,s=0,a={},i=!1;for(let n of t){let u=p++;r.resolve(n).then(d=>{a[u]=d,s++,i&&s===p&&e(a)},o)}if(s===p)return e(a);i=!0})}static race(t){return new r(e=>{for(let o of t)e(o)})}static reject(t){return new r((e,o)=>o(t))}static resolve(t){return new r(e=>e(t))}static allSettled(t){return new r(e=>{let o=0,p=0,s={},a=!1;for(let i of t){let n=o++;r.resolve(i).then(u=>{s[n]={status:"fulfilled",value:u},p++,a&&p===o&&e(s)},u=>{s[n]={status:"rejected",reason:u},p++,a&&p===o&&e(s)})}if(p===o)return e(s);a=!0})}static any(t){return new r((e,o)=>{let p=0,s=0,a=[],i=!1;for(let n of t){let u=p++;r.resolve(n).then(d=>e(d),d=>{a[u]=d,s++,i&&s===p&&o(new AggregateError(a,"All promises were rejected"))})}if(s===p)return o(new AggregateError(a,"All promises were rejected"));i=!0})}static sync(t){let e;if(t.then(o=>{e=new W(o)},o=>{e=new ge(o)}),e){let o=e;if(o instanceof W)return o.value;throw o.reason}return t}withResolvers(){let t,e;return t=e=()=>{throw new Error("not implemented")},{promise:new r((p,s)=>{t=p,e=s}),reject:e,resolve:t}}},je=class{constructor(t,e,o){this.promise=t;this.afterResolved=e;this.afterRejected=o}afterFulfilledCalled=!1;afterRejectedCalled=!1;then(t,e){return this.promise.then(t?o=>{let p=t(o);return this.afterFulfilledCalled||(this.afterResolved&&this.afterResolved(),this.afterFulfilledCalled=!0),p}:void 0,e?o=>{let p=e(o);return this.afterRejectedCalled||(this.afterRejected&&this.afterRejected(),this.afterRejectedCalled=!0),p}:void 0)}catch(t){return this.promise.then(void 0,t)}};function ht(r,t){let e=r.status,o=!1,p=r.constructor;Reflect.defineProperty(r,"status",{get:()=>e,set:s=>{e=s,e===p.STATUS_DONE&&(o||(o=!0,t()))}})}function Ve(r,t,e){let o=t.thread;if(r.sequencer.stepThread(e),e.isCompiled&&o&&o.isCompiled&&o.generator){let p=o.generator;o.generator={next:()=>{}},r.sequencer.stepThread(o),o.generator=p}}var pe=class r{constructor(t,e){this.runtime=t;this.util=e}static waitingThread=new WeakMap;create(t,e,o){return this.runtime._pushThread(t,e,o)}wait(t){let e=r.waitingThread.get(t);if(e)return e;let o=new $(p=>{ht(t,p),Ve(this.runtime,this.util,t)});return r.waitingThread.set(t,o),o}step(t){Ve(this.runtime,this.util,t)}};(function(r){let t="#808080";if(r.extensions.unsandboxed===!1)throw new Error("lpp must be loaded in unsandboxed mode.");function e(p){let s=Function.prototype.apply;Function.prototype.apply=function(i){return i};let a=p();return Function.prototype.apply=s,a}class o{vm;Blockly;extension;util;constructor(s){let a=s;this.Blockly=void 0,r.translate.setup(it);let i;if(a._events.QUESTION instanceof Array)for(let c of a._events.QUESTION){let f=e(c);if(f?.props?.vm){i=f?.props?.vm;break}}else a._events.QUESTION&&(i=e(a._events.QUESTION)?.props?.vm);if(!i)throw new Error("lpp cannot get Virtual Machine instance.");if(this.vm=i,this.extension=wt(t,this.vm.runtime,this.formatMessage.bind(this)),this.vm._events.EXTENSION_ADDED instanceof Array)for(let c of this.vm._events.EXTENSION_ADDED){let f=e(c);if(f?.ScratchBlocks){this.Blockly=f?.ScratchBlocks;break}}else this.vm._events.EXTENSION_ADDED&&(this.Blockly=e(this.vm._events.EXTENSION_ADDED)?.ScratchBlocks);if(this.Blockly){let c=this.Blockly,f=c.Events,h=f.Change.prototype.run;f.Change.prototype.run=function(k){h.call(this,k);let B=this,C=this.getEventWorkspace_().getBlockById(B.blockId);C instanceof c.BlockSvg&&(C.initSvg(),C.render())};let T=f.Move.prototype.run;f.Move.prototype.run=function(k){let B=this;this.getEventWorkspace_().getBlockById(B.blockId)&&T.call(this,k)};let v=f.Create.prototype.run;f.Create.prototype.run=function(k){let B=this,C=[],F=this.getEventWorkspace_();for(let G of B.ids)F.getBlockById(G)&&C.push(G);B.ids=C,v.call(this,k)}}let n=a.emit;a.emit=(c,...f)=>(["SAY","QUESTION"].includes(c)&&f.length>=1&&typeof f[0]=="object"&&f[0]!==null&&Reflect.get(f[0],"id")===""&&this.handleError(new L("useAfterDispose")),n.call(a,c,...f));let u=a.visualReport;a.visualReport=(c,f)=>{let h=S.unwrap(f);if((h instanceof I||h instanceof x||h instanceof U)&&this.Blockly){let T=h instanceof U?h:y(h);O.show(this.Blockly,c,[de(this.Blockly,this.vm,this.formatMessage.bind(this),T)],T instanceof l?"center":"left")}else return u.call(a,c,f)};let d=a.requestUpdateMonitor;if(d){let c=(T,v)=>{let k=T.querySelector('[class*="value"]');if(k instanceof HTMLElement){let B=Object.values(k).find(C=>typeof C=="object"&&C!==null&&Reflect.has(C,"stateNode"));if(v instanceof I){let C=de(this.Blockly,this.vm,this.formatMessage.bind(this),v);for(k.style.textAlign="left",k.style.backgroundColor="rgb(30, 30, 30)",k.style.color="#eeeeee";k.firstChild;)k.removeChild(k.firstChild);k.append(C)}else if(B){for(k.style.textAlign="",k.style.backgroundColor=B.memoizedProps?.style?.background??"",k.style.color=B.memoizedProps?.style?.color??"";k.firstChild;)k.removeChild(k.firstChild);k.append(String(v))}}},f=T=>{let v=document.querySelectorAll('[class*="monitor_monitor-container"]');for(let k of Object.values(v)){let B=Object.values(k).find(C=>typeof C=="object"&&C!==null&&Reflect.has(C,"children"));if(B){let C=B?.children?.props;if(T===C?.id)return k}}return null},h=new Map;a.requestUpdateMonitor=T=>{let v=T.get("id");if(typeof v=="string"){let k=T.get("value"),B=T.get("mode"),C=T.get("visible"),F=h.get(v);if(typeof B=="string"&&F)F.mode=B,F.value=void 0;else if(k!==void 0){let G=S.unwrap(k);if(G instanceof I||G instanceof x||G instanceof U){let P=G instanceof U?G:y(G);return(!F||F.value!==P)&&(requestAnimationFrame(()=>{let oe=f(v);oe&&c(oe,P)}),F?F.value=P:h.set(v,{value:P,mode:(()=>{if(a.getMonitorState){let oe=a.getMonitorState().get(v);if(oe){let Pe=oe.get("mode");return typeof Pe=="string"?Pe:"normal"}}return"normal"})()})),!0}else if(h.has(v)){let P=f(v);P&&c(P,k),h.delete(v)}}else C!==void 0&&(C||h.delete(v))}return d.call(a,T)}}D.Function.set("serialize",w.native(({args:c})=>{let f=c[0];if(!f||!(f instanceof w)||!re(f)||!(f.metadata instanceof H))return g(function*(){return j(yield D.IllegalInvocationError.construct([]))});let h=f.metadata.blocks[0]?.getBlock(f.metadata.blocks[1]);if(!h)throw new Error("lpp: serialize blockId invalid");return new m(o.serializeFunction(h,f.metadata.blocks[0],f.metadata.signature))})),D.Function.set("deserialize",w.native(({args:c})=>{let f=ie.toObject(c[0]??new l(null));if(Re.isInfo(f)){let h=a.flyoutBlocks.constructor,T=new h(a,!0);at(T,f.script);let v=a.getTargetForStage()?.constructor;if(!v)throw new Error("lpp: project is disposed");return new m(ue(new w(this.executeScratch.bind(this,v)),new H(f.signature,[T,f.block],void 0,void 0,void 0)))}return g(function*(){return j(yield D.SyntaxError.construct([new l("Invalid value")]))})})),mt(),a.lpp={Core:ze,Metadata:Be,Wrapper:S,version:Oe},console.groupCollapsed("\u{1F4AB} lpp",Oe),console.log("\u{1F31F}",this.formatMessage("lpp.about.summary")),console.log("\u{1F916}",this.formatMessage("lpp.about.github"),"-> https://github.com/FurryR/lpp-scratch"),console.log("\u{1F49E}",this.formatMessage("lpp.about.afdian"),"-> https://afdian.net/a/FurryR"),console.group("\u{1F47E}",this.formatMessage("lpp.about.staff.1"));for(let c of nt)console.log(c);console.log("\u{1F970}",this.formatMessage("lpp.about.staff.2")),console.groupEnd(),console.groupEnd()}formatMessage(s){return r.translate({id:s,default:s,description:s})}getInfo(){return this.Blockly&&this.extension.inject(this.Blockly),{id:"lpp",name:this.formatMessage("lpp.name"),color1:t,blocks:this.extension.export(),menus:{dummy:{acceptReporters:!1,items:[]}}}}documentation(){window.open(this.formatMessage("lpp.documentation.url"))}builtinType(s,a){this.util=a;let i=D[s.value];if(i)return new S(i);throw new Error("lpp: not implemented")}builtinError(s,a){return this.builtinType(s,a)}builtinUtility(s,a){return this.builtinType(s,a)}constructLiteral(s,a){this.util=a;let i=(()=>{switch(s.value){case"null":return new l(null);case"true":return new l(!0);case"false":return new l(!1);case"NaN":return new l(NaN);case"Infinity":return new l(1/0)}throw new Error("lpp: unknown literal")})();return new S(i)}binaryOp(s,a){this.util=a;try{let i=S.unwrap(s.lhs),n=S.unwrap(s.rhs),u=(()=>{if(s.op==="."){if(i instanceof I||i instanceof x){if(typeof n=="string"||typeof n=="number")return i.get(`${n}`);if(n instanceof I||n instanceof x){let d=y(n);if(d instanceof l&&d.value!==null)return i.get(d.toString())}throw new L("invalidIndex")}throw new L("syntaxError")}else if((i instanceof I||i instanceof x)&&(n instanceof I||n instanceof x))switch(s.op){case"=":case"+":case"*":case"==":case"!=":case">":case"<":case">=":case"<=":case"&&":case"||":case"-":case"/":case"%":case"<<":case">>":case">>>":case"&":case"|":case"^":case"instanceof":return i.calc(s.op,y(n));case"in":{let d=y(i),c=y(n);if(!(d instanceof l&&d.value!==null))throw new L("invalidIndex");return new l(c.has(d.toString()))}default:throw new Error("lpp: unknown operand")}throw new L("syntaxError")})();return new S(u)}catch(i){this.handleError(i)}}unaryOp(s,a){this.util=a;try{let i=S.unwrap(s.value);if(!(i instanceof I||i instanceof x))throw new L("syntaxError");let n=(()=>{switch(s.op){case"+":case"-":case"!":case"~":case"delete":return i.calc(s.op);case"...":{if(!(i instanceof E))throw new L("syntaxError");return new U(i.value)}default:throw new Error("lpp: unknown operand")}})();return new S(n)}catch(i){this.handleError(i)}}call(s,a){let{thread:i}=a;this.util=a;try{let{fn:n}=s;n=S.unwrap(n);let u=[],d=this.getActiveBlockInstance(s,i),c=parseInt(this.getMutation(d)?.length??"0",10);for(let T=0;T<c;T++){let v=S.unwrap(s[`ARG_${T}`]);if(v instanceof U)u.push(...v.value.map(k=>k??new l(null)));else if(v instanceof I||v instanceof x)u.push(y(v));else throw new L("syntaxError")}if(!(n instanceof I||n instanceof x))throw new L("syntaxError");let f=y(n),h=i;if(!(f instanceof w))throw new L("notCallable");return this.asap(g(function*(){return new S(this.processApplyValue(yield f.apply(n instanceof x?n.parent.deref()??new l(null):h.lpp?.unwind()?.self??new l(null),u),i))}.bind(this)),i)}catch(n){this.handleError(n)}}new(s,a){let{thread:i}=a;this.util=a;try{let{fn:n}=s;n=S.unwrap(n);let u=[],d=this.getActiveBlockInstance(s,i),c=parseInt(this.getMutation(d)?.length??"0",10);for(let f=0;f<c;f++){let h=S.unwrap(s[`ARG_${f}`]);if(h instanceof U)u.push(...h.value.map(T=>T??new l(null)));else if(h instanceof I||h instanceof x)u.push(y(h));else throw new L("syntaxError")}if(!(n instanceof I||n instanceof x))throw new L("syntaxError");return n=y(n),this.asap(g(function*(){if(!(n instanceof w))throw new L("notCallable");return new S(this.processApplyValue(yield n.construct(u),i))}.bind(this)),i)}catch(n){this.handleError(n)}}self(s,a){try{let{thread:i}=a;this.util=a;let n=i;if(n.lpp){let u=n.lpp.unwind();if(u)return new S(u.self)}throw new L("useOutsideFunction")}catch(i){this.handleError(i)}}constructNumber(s,a){let i=new l(Number(s.value));return this.util=a,new S(i)}constructString(s,a){let i=new l(String(s.value));return this.util=a,new S(i)}constructArray(s,a){try{let{thread:i}=a;this.util=a;let n=new E,u=this.getActiveBlockInstance(s,i),d=parseInt(this.getMutation(u)?.length??"0",10);for(let c=0;c<d;c++){let f=S.unwrap(s[`ARG_${c}`]);if(f instanceof U)n.value.push(...f.value);else if(f instanceof I||f instanceof x)n.value.push(y(f));else throw new L("syntaxError")}return new S(n)}catch(i){this.handleError(i)}}constructObject(s,a){try{let{thread:i}=a;this.util=a;let n=new M,u=this.getActiveBlockInstance(s,i),d=parseInt(this.getMutation(u)?.length??"0",10);for(let c=0;c<d;c++){let f=S.unwrap(s[`KEY_${c}`]),h=S.unwrap(s[`VALUE_${c}`]);if(typeof f=="string"||typeof f=="number")f=`${f}`;else if(f instanceof l)f=f.toString();else if(f instanceof x&&f.value instanceof l)f=f.value.toString();else throw new L("invalidIndex");if(!(h instanceof I||h instanceof x))throw new L("syntaxError");n.set(f,y(h))}return new S(n)}catch(i){this.handleError(i)}}constructFunction(s,a){try{let{thread:i,target:n}=a;this.util=a;let u=n.constructor,d=this.getActiveBlockInstance(s,i),c=[],f=parseInt(d?.mutation?.length??"0",10);for(let v=0;v<f;v++)if(typeof s[`ARG_${v}`]!="object")c[v]=String(s[`ARG_${v}`]);else throw new L("syntaxError");let h=i.target.blocks,T=i;return new S(ue(new w(this.executeScratch.bind(this,u)),new H(c,[h,d.id],n.sprite.clones[0].id,n.id,T.lpp)))}catch(i){this.handleError(i)}}var(s,a){try{let{thread:i}=a;this.util=a;let n=i;if(n.lpp){let u=n.lpp.get(s.name);return new S(u)}throw new L("useOutsideContext")}catch(i){this.handleError(i)}}return({value:s},a){try{let{thread:i}=a;if(this.util=a,s=S.unwrap(s),!(s instanceof I||s instanceof x))throw new L("syntaxError");let n=y(s),u=i;if(u.lpp){let d=u.lpp.unwind();if(d instanceof ce)return d.returnCallback(new m(n)),i.stopThisScript()}throw new L("useOutsideFunction")}catch(i){this.handleError(i)}}throw({value:s},a){try{let{thread:i}=a;if(this.util=a,s=S.unwrap(s),!(s instanceof I||s instanceof x))throw new L("syntaxError");let n=y(s),u=new R(n),d=i;if(u.pushStack(new Z.Block(i.target.sprite.clones[0].id,i.peekStack(),d.lpp??void 0)),d.lpp)return d.lpp.exceptionCallback(u),i.stopThisScript();this.handleException(u)}catch(i){this.handleError(i)}}scope(s,a){let{thread:i,target:n}=a;this.util=a;try{let d=this.getActiveBlockInstance(s,i).inputs.SUBSTACK?.block;if(!d)return;if(!this.util)throw new Error("lpp: util used initialization");let c=new pe(this.vm.runtime,this.util),f=i;return this.asap($.sync(new $(h=>{let T=c.create(d,n);T.lpp=new te(f.lpp??void 0,v=>{if(f.lpp)return f.lpp.returnCallback(v),T.stopThisScript();throw new L("useOutsideFunction")},v=>{if(f.lpp)return f.lpp.exceptionCallback(v),i.stopThisScript();this.handleException(v)}),h(c.wait(T).then(()=>{}))})),i)}catch(u){this.handleError(u)}}try(s,a){let{thread:i,target:n}=a;this.util=a;try{let u=this.getActiveBlockInstance(s,i),d=S.unwrap(s.var);if(!(d instanceof x))throw new L("syntaxError");let c=u.inputs.SUBSTACK?.block;if(!c)return;if(!this.util)throw new Error("lpp: util used before initialization");let f=new pe(this.vm.runtime,this.util),h=u.inputs.SUBSTACK_2?.block,T=i,v=f.create(c,n),k=!1;return this.asap($.sync(new $(B=>{v.lpp=new te(T.lpp??void 0,C=>{if(T.lpp)return T.lpp.returnCallback(C),v.stopThisScript();throw new L("useOutsideFunction")},C=>{if(k=!0,!h){B(void 0);return}let F=C.value;if(F.instanceof(D.Error)){let P=new E(C.stack.map(oe=>new l(oe.toString())));F.set("stack",P)}d.assign(F);let G=f.create(h,n);G.lpp=new te(T.lpp??void 0,P=>{if(T.lpp)return T.lpp.returnCallback(P),i.stopThisScript();throw new L("useOutsideFunction")},P=>{if(T.lpp)return T.lpp.exceptionCallback(P),i.stopThisScript();this.handleException(P)}),f.wait(G).then(()=>{B(void 0)})}),f.wait(v).then(()=>{k||B(void 0)})})),i)}catch(u){this.handleError(u)}}nop({value:s},a){let{thread:i}=a;if(this.util=a,i.stackClick&&i.atStackTop()&&!i.target.blocks.getBlock(i.peekStack())?.next&&s!==void 0)if(i.isCompiled)this.vm.runtime.visualReport(i.peekStack(),s);else return s}handleError(s){if(s instanceof L){let a=this.util?.thread;if(a){let i=a.peekStack();i&&(lt(this.Blockly,this.vm,this.formatMessage.bind(this),s.id,i,a.target.sprite.clones[0].id),this.vm.runtime.stopAll())}}throw s}handleException(s){throw ct(this.Blockly,this.vm,this.formatMessage.bind(this),s),this.vm.runtime.stopAll(),new Error("lpp: user exception")}processApplyValue(s,a){if(s instanceof m)return s.value;if(s.pushStack(new Z.Block(a.target.sprite.clones[0].id,a.peekStack(),a.lpp??void 0)),a.lpp)return a.lpp.exceptionCallback(s),void a.stopThisScript();this.handleException(s)}getActiveBlockInstance(s,a){let i=a.target.blocks,n=a.isCompiled?a.peekStack():i._cache._executeCached[a.peekStack()]?._ops?.find(d=>s===d._argValues)?.id,u=n?i.getBlock(n)??this.vm.runtime.flyoutBlocks.getBlock(n):void 0;if(!u)throw new Error("lpp: cannot get active block");return u}getMutation(s){return s.mutation}createDummyTarget(s,a){let i=new s({blocks:a,name:""},this.vm.runtime);i.id="";let n=()=>{this.handleError(new L("useAfterDispose"))};for(let u of Reflect.ownKeys(i.constructor.prototype))typeof u=="string"&&u.startsWith("set")&&Reflect.set(i,u,n);return Reflect.set(i,"makeClone",n),i}asap(s,a){if(!this.util)throw new Error("lpp: util used before initialization");let i=new pe(this.vm.runtime,this.util),n=()=>{i.step(a)};return J(s)?new je(s,n,n):s}executeScratch(s,a){if(re(a.fn)&&a.fn.metadata instanceof H){let i=a.fn.metadata,n;i.target&&(n=this.vm.runtime.getTargetById(i.target)),n||(n=this.createDummyTarget(s,i.blocks[0]));let u=i.blocks[0].getBlock(i.blocks[1])?.inputs.SUBSTACK?.block;if(!u)return new m(new l(null));if(!this.util)throw new Error("lpp: util used before initialization");let d=new pe(this.vm.runtime,this.util),c=d.create(u,n);return $.sync(new $(f=>{c.lpp=new ce(i.closure,a.self??new l(null),h=>{f(h)},h=>{f(h)});for(let[h,T]of i.signature.entries())h<a.args.length?c.lpp.closure.set(T,a.args[h]):c.lpp.closure.set(T,new l(null));d.wait(c).then(()=>{c?.lpp?.returnCallback(new m(new l(null)))})}))}return new m(new l(null))}static serializeFunction(s,a,i){let n={signature:i,script:st(a,s),block:s.id};return ie.fromObject(n)}}r.vm?.runtime?r.extensions.register(new o(r.vm.runtime)):Reflect.set(window,"tempExt",{Extension:o,info:{name:"lpp.name",description:"lpp.desc",extensionId:"lpp",iconURL:Ue,featured:!0,disabled:!1,collaboratorList:[{collaborator:"\u718A\u8C37 \u51CC",collaboratorURL:"https://github.com/FurryR"},{collaborator:"...",collaboratorURL:"https://github.com/FurryR/lpp-scratch"}]},l10n:{"zh-cn":{"lpp.name":"lpp","lpp.desc":"\u{1F6E0}\uFE0F (\u5B9E\u9A8C\u6027) \u4E00\u95E8\u57FA\u4E8E Scratch \u7684\u9AD8\u7EA7\u7F16\u7A0B\u8BED\u8A00\u3002"},en:{"lpp.name":"lpp","lpp.desc":"\u{1F6E0}\uFE0F (Experimental) A high-level programming language based on Scratch"}}})})(Scratch);})();
